(function(){"use strict";var e={2768:function(e,t,i){var a=i(9963),s=i(6252);const o={translate:"no"};function n(e,t,i,a,n,r){const l=(0,s.up)("NavBar"),c=(0,s.up)("router-view"),d=(0,s.up)("SocialsFooter"),u=(0,s.up)("NoAccessOverlay");return(0,s.wg)(),(0,s.iD)("div",o,[(0,s.Wm)(l),(0,s.Wm)(c),null==e.$route.meta.footer?((0,s.wg)(),(0,s.j4)(d,{key:0})):(0,s.kq)("",!0),null!=e.$route.meta.noAccess?((0,s.wg)(),(0,s.j4)(u,{key:1})):(0,s.kq)("",!0)])}var r=i.p+"img/logo_transparent.67ae4d7f.png";const l=e=>((0,s.dD)("data-v-6d334a86"),e=e(),(0,s.Cn)(),e),c=l((()=>(0,s._)("hr",null,null,-1))),d=l((()=>(0,s._)("img",{class:"logo",src:r},null,-1))),u=l((()=>(0,s._)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarToggler","aria-controls":"navbarToggler"},[(0,s._)("span",{class:"navbar-toggler-icon"})],-1))),p={class:"collapse navbar-collapse",id:"navbarToggler"},m={class:"navbar-nav ms-auto"},h={class:"nav-item"},g={class:"nav-item"},y={class:"nav-item"},f={class:"nav-item"},v={class:"nav-item"},b={class:"nav-item"};function w(e,t,i,a,o,n){const r=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)(s.HY,null,[c,(0,s._)("header",{onClick:t[0]||(t[0]=(...e)=>n.changeLinkColors&&n.changeLinkColors(...e)),class:"navbar navbar-expand-lg navbar-light sticky-top"},[(0,s.Wm)(r,{to:"/",class:"brand navbar-brand"},{default:(0,s.w5)((()=>[d,(0,s.Uk)(" Intern ")])),_:1}),u,(0,s._)("div",p,[(0,s._)("ul",m,[(0,s._)("li",h,[(0,s.Wm)(r,{class:"nav-link",to:"/stats"},{default:(0,s.w5)((()=>[(0,s.Uk)("Statistiken")])),_:1})]),(0,s._)("li",g,[(0,s.Wm)(r,{class:"nav-link",to:"/orders"},{default:(0,s.w5)((()=>[(0,s.Uk)("Bestellungen")])),_:1})]),(0,s._)("li",y,[(0,s.Wm)(r,{class:"nav-link",to:"/services"},{default:(0,s.w5)((()=>[(0,s.Uk)("Services")])),_:1})]),(0,s._)("li",f,[(0,s.Wm)(r,{class:"nav-link",to:"/companies"},{default:(0,s.w5)((()=>[(0,s.Uk)("Unternehmen")])),_:1})]),(0,s._)("li",v,[(0,s.Wm)(r,{class:"nav-link",to:"/users"},{default:(0,s.w5)((()=>[(0,s.Uk)("Nutzer")])),_:1})]),(0,s._)("li",b,[(0,s.Wm)(r,{class:"nav-link",to:"/settings"},{default:(0,s.w5)((()=>[(0,s.Uk)("Einstellungen")])),_:1})])])])])],64)}var _={name:"NavBar",props:{info:String},data(){return{mainUrl:"https://schillerando.de"}},mounted(){this.changeLinkColors()},methods:{changeLinkColors(){const e=window.location.href.split("/"),t=e[e.length-1],i=document.getElementsByClassName("nav-link");for(var a=0;a<i.length;a++)i[a].style.color="#000";switch(t){case"stats":i[0].style.color="#00a100";break;case"orders":i[1].style.color="#00a100";break;case"services":i[2].style.color="#00a100";break;case"companies":i[3].style.color="#00a100";break;case"users":i[4].style.color="#00a100";break;case"settings":i[5].style.color="#00a100";break;default:break}}}},k=i(3744);const E=(0,k.Z)(_,[["render",w],["__scopeId","data-v-6d334a86"]]);var C=E;const S=e=>((0,s.dD)("data-v-205cca34"),e=e(),(0,s.Cn)(),e),D={id:"footer",class:"container-fluid"},I=S((()=>(0,s._)("div",{class:"container-fluid"},[(0,s._)("a",{href:"mailto:info@schillerando.de"},[(0,s._)("i",{class:"social-icon fa-solid fa-lg fa-envelope"})]),(0,s._)("a",{tabindex:"0",role:"button","data-bs-toggle":"popover","data-bs-trigger":"focus","data-bs-placement":"top","data-bs-content":'\r\n      <div>\r\n        <p>\r\n          Hierbei handelt es sich um ein Unternehmen für das Schulprojekt Schule als Staat 2023 des FSG Marbach und um kein echtes Unternehmen \r\n        </p>\r\n        <p>\r\n          <strong>Impressum:</strong>\r\n          <br>Felix Haag\r\n          <br>Schulstraße 34\r\n          <br>71672 Marbach am Neckar\r\n          <br>Telefon: <a href="tel:+4915759664764">0157 / 59 66 47 64</a>\r\n          <br>E-Mail: <a href="mailto:info@schillerando.de">info@schillerando.de</a>\r\n        </p>\r\n      </div>'},[(0,s._)("i",{class:"social-icon fa-solid fa-lg fa-circle-info"})]),(0,s._)("a",{href:"https://www.instagram.com/schillerando/"},[(0,s._)("i",{class:"social-icon fab fa-lg fa-instagram"})]),(0,s._)("p",null,"© Schillerando")],-1))),P=[I];function B(e,t,i,a,o,n){return(0,s.wg)(),(0,s.iD)("footer",D,P)}var x=i(5577),A={name:"ProductView",mounted(){Array.from(document.querySelectorAll('a[data-bs-toggle="popover"]')).forEach((e=>new x.Popover(e,{html:!0})))}};const T=(0,k.Z)(A,[["render",B],["__scopeId","data-v-205cca34"]]);var L=T,q=i.p+"img/lock.41092fc5.png";const O=e=>((0,s.dD)("data-v-8f87938e"),e=e(),(0,s.Cn)(),e),U={key:0},F={key:0,class:"overlay"},j=O((()=>(0,s._)("div",{class:"centered"},[(0,s._)("img",{class:"lock",src:q,alt:""}),(0,s._)("h4",{class:"mt-3"},"Auf diese Seite haben nur Admins Zugriff!")],-1))),z=[j];function M(e,t,i,a,o,n){return null!=a.userData?((0,s.wg)(),(0,s.iD)("div",U,["admin"!=a.userData.role?((0,s.wg)(),(0,s.iD)("div",F,z)):(0,s.kq)("",!0)])):(0,s.kq)("",!0)}var V=i(3907),N=i(2201),G={name:"NoAccessOverlay",setup(){const e=(0,V.oR)(),t=(0,N.tv)(),i=(0,s.Fl)((()=>e.state.user));return{store:e,router:t,userData:i}}};const Z=(0,k.Z)(G,[["render",M],["__scopeId","data-v-8f87938e"]]);var W=Z,R={name:"App",components:{NavBar:C,SocialsFooter:L,NoAccessOverlay:W},setup(){const e=(0,V.oR)();return e.dispatch("reload"),{store:e}}};const K=(0,k.Z)(R,[["render",n]]);var $=K;const H=e=>((0,s.dD)("data-v-e7eff258"),e=e(),(0,s.Cn)(),e),Y={key:0,style:{"margin-bottom":"100px"}},J={class:"nav","aria-label":"Page navigation example"},Q={class:"pagination"},X={class:"page-item"},ee={class:"page-item"},te={class:"page-item"},ie={key:0,class:"container"},ae={class:"row"},se={class:"col-12"},oe={key:0,class:"alert alert-warning",role:"alert"},ne={class:"col-lg-8"},re={class:"card m-1"},le=H((()=>(0,s._)("div",{class:"card-header"},"Informationen",-1))),ce={class:"card-body"},de={class:"image"},ue={key:0,class:"no-image"},pe=H((()=>(0,s._)("i",{class:"fa-solid fa-image fa-2xl"},null,-1))),me=[pe],he=["src"],ge=["disabled"],ye={class:"needs-validation",novalidate:""},fe={class:"input-group mb-3"},ve=H((()=>(0,s._)("span",{class:"input-group-text"},[(0,s._)("i",{class:"fa-solid fa-shop"})],-1))),be=["value","disabled"],we={class:"input-group mb-3"},_e=H((()=>(0,s._)("span",{class:"input-group-text"},[(0,s._)("i",{class:"fa-solid fa-location-dot"})],-1))),ke=["value","disabled"],Ee={class:"input-group mb-3"},Ce=H((()=>(0,s._)("span",{class:"input-group-text"},[(0,s._)("i",{class:"fa-solid fa-list"})],-1))),Se=["value","disabled"],De=(0,s.uE)('<option selected data-v-e7eff258>Kategorie</option><option value="Gastronomie" data-v-e7eff258>Gastronomie</option><option value="Kultur" data-v-e7eff258>Kultur</option><option value="Dienstleistung" data-v-e7eff258> Dienstleistung </option><option style="color:red;" value="Gastronomie &amp; Dienstleistung" data-v-e7eff258> Gastronomie &amp; Dienstleistung </option>',5),Ie=[De],Pe={class:"input-group mb-3"},Be=H((()=>(0,s._)("span",{class:"input-group-text"},[(0,s._)("i",{class:"fa-solid fa-circle-info"})],-1))),xe=["value","disabled"],Ae={class:"form-check form-switch"},Te=["disabled","checked"],Le=H((()=>(0,s._)("label",{class:"form-check-label",for:"flexSwitchCheckChecked"},"Verifiziert",-1))),qe={key:0,class:"py-2",style:{width:"fit-content"}},Oe={key:1,style:{display:"flex"}},Ue={class:"py-2 mx-0 edit-buttons"},Fe=H((()=>(0,s._)("div",{class:"loading-button"},"Speichern",-1))),je=H((()=>(0,s._)("div",{class:"spinner"},[(0,s._)("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),(0,s._)("span",{class:"sr-only"},"Loading...")],-1))),ze=[Fe,je],Me={class:"py-2 mx-0 edit-buttons"},Ve={class:"col-lg-4"},Ne={class:"card m-1"},Ge=H((()=>(0,s._)("div",{class:"card-header"},"Mitarbeiter",-1))),Ze={class:"card-body"},We={class:"input-group mb-3"},Re=H((()=>(0,s._)("span",{class:"input-group-text"},[(0,s._)("i",{class:"fa fa-envelope"})],-1))),Ke=["value","disabled","onInput"],$e=["onClick"],He=H((()=>(0,s._)("i",{class:"fa fa-trash"},null,-1))),Ye=[He],Je={key:0,class:"py-2",style:{width:"fit-content"}},Qe={key:1},Xe={style:{display:"flex"}},et={class:"py-2 mx-0 edit-buttons"},tt=H((()=>(0,s._)("div",{class:"loading-button"},"Speichern",-1))),it=H((()=>(0,s._)("div",{class:"spinner"},[(0,s._)("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),(0,s._)("span",{class:"sr-only"},"Loading...")],-1))),at=[tt,it],st={class:"py-2 mx-0 edit-buttons"};function ot(e,t,i,a,o,n){const r=(0,s.up)("AlertPopup"),l=(0,s.up)("ProductView"),c=(0,s.up)("AccountingView");return void 0!=o.company?((0,s.wg)(),(0,s.iD)("div",Y,[(0,s.Wm)(r,{title:this.alertTitle,info:this.alertInfo},null,8,["title","info"]),(0,s._)("div",J,[(0,s._)("ul",Q,[(0,s._)("li",X,[(0,s._)("a",{class:"page-link",onClick:t[0]||(t[0]=e=>this.page=0)},"Einstellungen")]),(0,s._)("li",ee,[(0,s._)("a",{class:"page-link",onClick:t[1]||(t[1]=e=>this.page=1)},"Produkte")]),(0,s._)("li",te,[(0,s._)("a",{class:"page-link",onClick:t[2]||(t[2]=e=>this.page=2)},"Buchhaltung")])])]),0==this.page?((0,s.wg)(),(0,s.iD)("div",ie,[(0,s._)("div",ae,[(0,s._)("div",se,[0==o.company.verified?((0,s.wg)(),(0,s.iD)("div",oe," Das Unternehmen muss noch überprüft werden. ")):(0,s.kq)("",!0)]),(0,s._)("div",ne,[(0,s._)("div",re,[le,(0,s._)("div",ce,[(0,s._)("div",de,[null==a.form.image?((0,s.wg)(),(0,s.iD)("div",ue,me)):((0,s.wg)(),(0,s.iD)("img",{key:1,src:this.form.image,alt:"Unternehmen Bild",id:"companyImage"},null,8,he))]),(0,s._)("input",{class:"form-control form-control-sm mb-4",type:"file",id:"formFile",accept:"image/*",onChange:t[3]||(t[3]=e=>n.imageInput()),disabled:!o.isCompanyEditing},null,40,ge),(0,s._)("form",ye,[(0,s._)("div",fe,[ve,(0,s._)("input",{type:"text",id:"company-name",class:"form-control",placeholder:"Name",onInput:t[4]||(t[4]=e=>n.validateCompanyChange(!1)),value:o.company.name,disabled:!o.isCompanyEditing,required:""},null,40,be)]),(0,s._)("div",we,[_e,(0,s._)("input",{type:"text",id:"company-location",class:"form-control",placeholder:"Raum, Pausenhof, ...",onInput:t[5]||(t[5]=e=>n.validateCompanyChange(!1)),value:o.company.location,disabled:!o.isCompanyEditing,required:""},null,40,ke)]),(0,s._)("div",Ee,[Ce,(0,s._)("select",{class:"form-select",id:"company-category","aria-label":"Default select example",value:o.company.categories[0],onChange:t[6]||(t[6]=e=>n.validateCompanyChange(!1)),disabled:!o.isCompanyEditing,required:"",color:{isCompanyEditing:"red"}},Ie,40,Se)]),(0,s._)("div",Pe,[Be,(0,s._)("textarea",{type:"text",id:"company-info",class:"form-control",placeholder:"Beschreibung",required:"",maxlength:"400",style:{resize:"none"},rows:"5",cols:"50",onInput:t[7]||(t[7]=e=>n.validateCompanyChange(!1)),value:o.company.info,disabled:!o.isCompanyEditing},null,40,xe)]),(0,s._)("div",Ae,[(0,s._)("input",{disabled:!o.isCompanyEditing,onClick:t[8]||(t[8]=e=>n.validateCompanyChange(!1)),checked:o.company.verified,class:"form-check-input",type:"checkbox",role:"switch",id:"company-verified"},null,8,Te),Le])]),o.isCompanyEditing?((0,s.wg)(),(0,s.iD)("div",Oe,[(0,s._)("div",Ue,[(0,s._)("button",{type:"button",class:"btn btn-primary px-2 mx-2",onClick:t[10]||(t[10]=e=>n.validateCompanyChange(!0))},ze)]),(0,s._)("div",Me,[(0,s._)("button",{type:"button",class:"btn btn-warning px-2 mx-2",onClick:t[11]||(t[11]=e=>n.cancelCompanyChange())}," Abbrechen ")])])):((0,s.wg)(),(0,s.iD)("div",qe,[(0,s._)("button",{type:"button",class:"btn btn-primary px-2 mx-2",onClick:t[9]||(t[9]=e=>n.editCompany())}," Bearbeiten ")]))])])]),(0,s._)("div",Ve,[(0,s._)("div",Ne,[Ge,(0,s._)("div",Ze,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.employees,((e,t)=>((0,s.wg)(),(0,s.iD)("div",{key:e},[(0,s._)("div",We,[Re,(0,s._)("input",{type:"email",class:"form-control employees-mail",placeholder:"Email","data-regex":"[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$",value:o.employees[t],disabled:!o.isEmployeesEditing,required:"",onInput:e=>n.validateEmployeesChange(!1,t)},null,40,Ke),o.isEmployeesEditing?((0,s.wg)(),(0,s.iD)("button",{key:0,class:"input-group-text",onClick:e=>o.employees.splice(t,1)},Ye,8,$e)):(0,s.kq)("",!0)])])))),128)),(0,s._)("div",null,[o.isEmployeesEditing?((0,s.wg)(),(0,s.iD)("div",Qe,[this.employees.length<6?((0,s.wg)(),(0,s.iD)("button",{key:0,type:"button",onClick:t[13]||(t[13]=e=>n.addEmployee()),class:"btn btn-primary my-4",style:{width:"max-content",display:"block"}}," Mitarbeiter hinzufügen ")):(0,s.kq)("",!0),(0,s._)("div",Xe,[(0,s._)("div",et,[(0,s._)("button",{type:"button",class:"btn btn-primary px-2 mx-2",onClick:t[14]||(t[14]=e=>n.validateEmployeesChange(!0,0))},at)]),(0,s._)("div",st,[(0,s._)("button",{type:"button",class:"btn btn-warning px-2 mx-2",onClick:t[15]||(t[15]=e=>n.cancelEmployeesChange())}," Abbrechen ")])])])):((0,s.wg)(),(0,s.iD)("div",Je,[(0,s._)("button",{type:"button",class:"btn btn-primary px-2 mx-2",onClick:t[12]||(t[12]=e=>n.editEmployees())}," Bearbeiten ")]))])])])])])])):1==this.page?((0,s.wg)(),(0,s.j4)(l,{key:1,companyData:o.company},null,8,["companyData"])):2==this.page?((0,s.wg)(),(0,s.j4)(c,{key:2,companyData:o.company},null,8,["companyData"])):(0,s.kq)("",!0)])):(0,s.kq)("",!0)}i(7658);var nt=i(9802);const rt="https://jwfyrkfpqfkzovzdpkqt.supabase.co",lt="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp3Znlya2ZwcWZrem92emRwa3F0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2NzkyNDg4MjcsImV4cCI6MTk5NDgyNDgyN30.ECsAuWRN08LWBqJZqa4v3Qmnx03N8wkGrTRgVMotCS8",ct=(0,nt.eI)(rt,lt);var dt=i(2262),ut=i(3577);const pt={class:"modal fade",id:"alertModal",tabindex:"-1","aria-labelledby":"alertPopupLabel","aria-hidden":"true"},mt={class:"modal-dialog"},ht={class:"modal-content"},gt={class:"modal-header"},yt={class:"modal-title fs-5",id:"alertPopupLabel"},ft={class:"modal-body"},vt=(0,s._)("div",{class:"modal-footer"},[(0,s._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Schließen ")],-1);function bt(e,t,i,a,o,n){return(0,s.wg)(),(0,s.iD)("div",pt,[(0,s._)("div",mt,[(0,s._)("div",ht,[(0,s._)("div",gt,[(0,s._)("h1",yt,(0,ut.zw)(i.title),1)]),(0,s._)("div",ft,[(0,s._)("p",null,(0,ut.zw)(i.info),1)]),vt])])])}var wt={name:"AlertPopup",data(){return{show:!1}},props:{title:String,info:String}};const _t=(0,k.Z)(wt,[["render",bt]]);var kt=_t;const Et=e=>((0,s.dD)("data-v-bbfd3550"),e=e(),(0,s.Cn)(),e),Ct={style:{width:"100vw"}},St=Et((()=>(0,s._)("p",{style:{"margin-bottom":"20px","margin-top":"-20px"}},[(0,s.Uk)(" $ "),(0,s._)("span",{style:{"font-size":"1.3rem"}},"≙"),(0,s.Uk)(" Schilli (1$ = 0.1€) ")],-1))),Dt={class:"row"},It={class:"col-12 total-numbers"},Pt={class:"row table"},Bt={class:"col-lg-4 equal"},xt={class:"card"},At={class:"card-body"},Tt=Et((()=>(0,s._)("h3",null,"Gewinn / Verlust",-1))),Lt={class:"euroProfit"},qt={key:0,id:"tooltip",tabindex:"0","data-bs-toggle":"tooltip","data-bs-placement":"top",title:"mit 20% Umtauschsteuer"},Ot=Et((()=>(0,s._)("i",{class:"fa-regular fa-circle-question fa-lg"},null,-1))),Ut=[Ot],Ft={class:"col-lg-4 equal"},jt={class:"card"},zt={class:"card-body"},Mt=Et((()=>(0,s._)("h3",null,"Einnahmen",-1))),Vt={class:"col-lg-4 equal"},Nt={class:"card"},Gt={class:"card-body"},Zt=Et((()=>(0,s._)("h3",null,"Ausgaben",-1))),Wt={class:"col-lg-6"},Rt={class:"canvas"},Kt={class:"col-lg-6"},$t={class:"entries"};function Ht(e,t,i,a,o,n){const r=(0,s.up)("EditAccountingEntryOverlay"),l=(0,s.up)("TitleDiv"),c=(0,s.up)("SortableList");return(0,s.wg)(),(0,s.iD)(s.HY,null,[o.newEntry?((0,s.wg)(),(0,s.j4)(r,{key:0,products:o.products,companyData:i.companyData,onStopEditingEntry:t[0]||(t[0]=e=>n.stopEditingEntry(e)),onDeleteEntry:t[1]||(t[1]=e=>n.deleteEntry())},null,8,["products","companyData"])):(0,s.kq)("",!0),(0,s._)("div",Ct,[(0,s.Wm)(l,{title:"Buchhaltung"}),St,(0,s._)("button",{class:"btn btn-primary mb-4 add-product",onClick:t[2]||(t[2]=e=>n.addEntry())}," Eintrag hinzufügen "),(0,s._)("div",Dt,[(0,s._)("div",It,[(0,s._)("div",Pt,[(0,s._)("div",Bt,[(0,s._)("div",xt,[(0,s._)("div",At,[((0,s.wg)(),(0,s.iD)("div",{key:o.key,class:(0,ut.C_)(["profit",{revenue:o.profit>0,expenses:o.profit<0}])},[Tt,(0,s._)("h1",null,(0,ut.zw)(o.profit)+" $",1),(0,s._)("div",Lt,(0,ut.zw)(o.euroProfit)+" €",1),o.profit>0?((0,s.wg)(),(0,s.iD)("a",qt,Ut)):(0,s.kq)("",!0)],2))])])]),(0,s._)("div",Ft,[(0,s._)("div",jt,[(0,s._)("div",zt,[((0,s.wg)(),(0,s.iD)("div",{key:o.key,class:"revenue"},[Mt,(0,s._)("h1",null,(0,ut.zw)(o.revenue)+" $",1)]))])])]),(0,s._)("div",Vt,[(0,s._)("div",Nt,[(0,s._)("div",Gt,[((0,s.wg)(),(0,s.iD)("div",{key:o.key,class:"expenses"},[Zt,(0,s._)("h1",null,(0,ut.zw)(o.expenses)+" $",1)]))])])])])]),(0,s._)("div",Wt,[(0,s._)("div",Rt,[((0,s.wg)(),(0,s.iD)("canvas",{key:o.key,id:"total-chart"})),((0,s.wg)(),(0,s.iD)("canvas",{key:o.key,id:"type-chart"}))])]),(0,s._)("div",Kt,[(0,s._)("div",$t,[((0,s.wg)(),(0,s.j4)(c,{items:o.entries,products:o.products,companyData:i.companyData,key:o.key,element:"AccountingEntryTile",onDeleteEntry:t[3]||(t[3]=e=>n.deleteEntry(e)),onStopEditingEntry:t[4]||(t[4]=e=>n.stopEditingEntry(e))},null,8,["items","products","companyData"]))])])])])],64)}const Yt={id:"title"},Jt={class:"container-fluid"},Qt={class:"title"};function Xt(e,t,i,a,o,n){return(0,s.wg)(),(0,s.iD)("section",Yt,[(0,s._)("div",Jt,[(0,s._)("h1",Qt,(0,ut.zw)(i.title),1)])])}var ei={name:"TitleDiv",props:{title:String}};const ti=(0,k.Z)(ei,[["render",Xt],["__scopeId","data-v-e14251b2"]]);var ii=ti;const ai=e=>((0,s.dD)("data-v-25e5a016"),e=e(),(0,s.Cn)(),e),si={class:"overlay"},oi={class:"card"},ni={class:"card-header"},ri=ai((()=>(0,s._)("h4",{class:"card-title"},"Eintrag",-1))),li={class:"card-body scroll mt-4"},ci={class:"needs-validation",novalidate:""},di={class:"input-group mb-3"},ui=ai((()=>(0,s._)("span",{class:"input-group-text"},[(0,s._)("i",{class:"fa-solid fa-list"})],-1))),pi=["value"],mi=(0,s.uE)('<option value="" selected data-v-25e5a016>Typ</option><option value="Verkauf+" data-v-25e5a016> Verkauf </option><option value="Einkauf-" data-v-25e5a016>Einkauf</option><option value="Gehalt-" data-v-25e5a016>Gehalt</option><option value="Miete-" data-v-25e5a016>Miete</option><option value="Steuern-" data-v-25e5a016>Steuern</option><option value="Sonstige Einnahme+" data-v-25e5a016> Sonstige Einnahme </option><option value="Sonstige Ausgabe-" data-v-25e5a016>Sonstige Ausgabe</option>',8),hi=[mi],gi={key:0,class:"input-group mb-3"},yi=ai((()=>(0,s._)("span",{class:"input-group-text"},[(0,s._)("i",{class:"fa-solid fa-box-open"})],-1))),fi=["value"],vi=ai((()=>(0,s._)("option",{value:"",selected:""},"Produkt",-1))),bi=["value"],wi={class:"input-group mb-3"},_i=ai((()=>(0,s._)("span",{class:"input-group-text"},[(0,s._)("i",{class:"fa-solid fa-bookmark"})],-1))),ki=["value"],Ei={class:"input-group mb-3"},Ci={class:"input-group-text"},Si=["value"],Di={class:"input-group mb-3"},Ii=ai((()=>(0,s._)("span",{class:"input-group-text"},[(0,s._)("i",{class:"fa-solid fa-circle-info"})],-1))),Pi=["value"],Bi={key:0,style:{"font-weight":"300","font-size":"0.9rem"}},xi=["src"],Ai={class:"card-footer"},Ti={key:1,class:"confirm"},Li=ai((()=>(0,s._)("i",{class:"fa-solid fa-check fa-lg"},null,-1))),qi=[Li],Oi=ai((()=>(0,s._)("i",{class:"fa-solid fa-xmark fa-lg"},null,-1))),Ui=[Oi];function Fi(e,t,i,a,o,n){const r=(0,s.up)("AlertPopup");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(r,{title:this.alertTitle,info:this.alertInfo},null,8,["title","info"]),(0,s._)("div",si,[(0,s._)("div",oi,[(0,s._)("div",ni,[(0,s._)("div",null,[ri,(0,s._)("button",{type:"button",class:"btn-close","aria-label":"Close",onClick:t[0]||(t[0]=e=>n.stopEditingEntry())})])]),(0,s._)("div",li,[(0,s._)("form",ci,[(0,s._)("div",di,[ui,(0,s._)("select",{class:"form-select",id:"entry-type","aria-label":"Default select example",value:a.entry.type,onChange:t[1]||(t[1]=e=>n.validateEntry(!1)),required:""},hi,40,pi)]),"Verkauf+"==a.entry.type?((0,s.wg)(),(0,s.iD)("div",gi,[yi,(0,s._)("select",{class:"form-select",id:"entry-product","aria-label":"Default select example",value:a.entry.product.id,onChange:t[2]||(t[2]=e=>n.validateEntry(!1,!0))},[vi,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.products,(e=>((0,s.wg)(),(0,s.iD)("option",{key:e.id,value:e.id},(0,ut.zw)(e.name)+" | "+(0,ut.zw)(e.price)+" $",9,bi)))),128))],40,fi)])):(0,s.kq)("",!0),(0,s._)("div",wi,[_i,(0,s._)("input",{type:"text",id:"entry-name",class:"form-control",onInput:t[3]||(t[3]=e=>n.validateEntry(!1)),placeholder:"Name",value:a.entry.name,required:""},null,40,ki)]),(0,s._)("div",Ei,[(0,s._)("span",Ci,[(0,s._)("i",{class:(0,ut.C_)(["fa-solid fa-dollar-sign",{income:a.entry.type.includes("+"),expense:a.entry.type.includes("-")}])},null,2)]),(0,s._)("input",{type:"number",id:"entry-amount",class:(0,ut.C_)(["form-control",{income:a.entry.type.includes("+"),expense:a.entry.type.includes("-")}]),onInput:t[4]||(t[4]=e=>n.validateEntry(!1)),placeholder:"Betrag",value:0==Math.abs(a.entry.amount)?"":Math.abs(a.entry.amount),required:""},null,42,Si)]),(0,s._)("div",Di,[Ii,(0,s._)("textarea",{type:"text",id:"entry-info",class:"form-control",onInput:t[5]||(t[5]=e=>n.validateEntry(!1)),placeholder:"Beschreibung",maxlength:"100",style:{resize:"none"},rows:"5",cols:"50",value:a.entry.info},null,40,Pi)])]),null==a.entry.image?((0,s.wg)(),(0,s.iD)("p",Bi,"Füge einen Kassenzettel, eine Rechnung oder ähnliches hinzu.")):(0,s.kq)("",!0),null!=a.entry.image?((0,s.wg)(),(0,s.iD)("img",{key:1,src:this.entry.image,alt:"Unternehmen Bild",id:"productImage"},null,8,xi)):(0,s.kq)("",!0),(0,s._)("input",{class:"form-control form-control-sm col-7",type:"file",id:"formFile",accept:"image/*",onChange:t[6]||(t[6]=e=>n.imageInput())},null,32)]),(0,s._)("div",Ai,[(0,s._)("button",{class:"btn btn-primary save-button",onClick:t[7]||(t[7]=e=>n.validateEntry(!0))},"Speichern"),this.delete||""==a.initialEntry.name?this.delete&&""!=a.initialEntry.name?((0,s.wg)(),(0,s.iD)("div",Ti,[(0,s._)("button",{class:"btn btn-primary confirm-button",onClick:t[9]||(t[9]=e=>n.deleteEntry())},qi),(0,s._)("button",{class:"btn btn-danger confirm-button",onClick:t[10]||(t[10]=e=>this.delete=!1)},Ui)])):(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("button",{key:0,class:"btn btn-danger delete-button",onClick:t[8]||(t[8]=e=>this.delete=!0)},"Löschen"))])])])],64)}var ji=i(7632),zi={name:"EditEntryOverlay",props:["data","edit","products","companyData"],components:{AlertPopup:kt},emits:["stopEditingEntry","deleteEntry"],data(){return{continuePressed:!1,alertTitle:"",alertInfo:"",successAlertTitle:"Erfolgreich",successAlertInfo:"Aktion wurde erfolgreich durchgeführt",failureAlertTitle:"Fehler",failureAlertInfo:"Es ist ein Fehler aufgetreten!",delete:!1}},setup(){var e=(0,dt.qj)({id:null,name:"",type:"",info:"",amount:"",product:null,created_at:"",imageBefore:null,image:null,bill_picture:""}),t=(0,dt.qj)({id:null,name:"",type:"",info:"",amount:"",product:null,created_at:"",imageBefore:null,image:null,bill_picture:""}),i=(0,dt.qj)({id:null,name:"",info:"",categories:[],price:"",delivery:!0,public:!0,product_picture:""});const a=(0,V.oR)();return{store:a,entry:e,initialEntry:t,product:i}},mounted(){if(null!=this.data){this.entry.id=this.data.id,this.entry.name=this.data.name,this.entry.type=this.data.type,this.entry.info=this.data.info,this.entry.amount=this.data.amount;var e=this.products.find((e=>e.id==this.data.product));this.entry.product=null!=e?e:this.product,this.entry.imageBefore=this.data.image,this.entry.image=this.data.image,this.entry.bill_picture=this.data.bill_picture,this.initialEntry.id=this.data.id,this.initialEntry.name=this.data.name,this.initialEntry.type=this.data.type,this.initialEntry.info=this.data.info,this.initialEntry.amount=this.data.amount,this.initialEntry.product=null!=e?e:this.product,this.initialEntry.imageBefore=this.data.image,this.initialEntry.image=this.data.image,this.initialEntry.bill_picture=this.data.bill_picture}else this.entry.id=(0,ji.Z)(),this.initialEntry.id=this.entry.id,this.entry.product=this.product,this.initialEntry.product=this.product},computed:{...(0,V.Se)(["getState"])},watch:{getState(e){var t=document.getElementsByClassName("spinner"),i=document.getElementsByClassName("loading-button");if("loading"==e)Array.from(t).forEach((e=>{e.style.visibility="visible",e.style.position="relative"})),Array.from(i).forEach((e=>{e.style.visibility="hidden",e.style.position="absolute"}));else if("success"==e)Array.from(t).forEach((e=>{e.style.visibility="hidden",e.style.position="absolute"})),Array.from(i).forEach((e=>{e.style.visibility="visible",e.style.position="relative"})),this.alertTitle=this.successAlertTitle,this.alertInfo=this.successAlertInfo,""!=this.alertTitle&&(a=new x.Modal(document.getElementById("alertModal"),{}),a.show()),this.stopEditingEntry();else if(Array.from(t).forEach((e=>{e.style.visibility="hidden",e.style.position="absolute"})),Array.from(i).forEach((e=>{e.style.visibility="visible",e.style.position="relative"})),this.alertTitle=this.failureAlertTitle,this.alertInfo=this.failureAlertInfo,""!=this.alertTitle){var a=new x.Modal(document.getElementById("alertModal"),{});a.show()}}},methods:{async stopEditingEntry(){const e=this.store.getters.getCurrentEntry;if(this.store.commit("setCurrentEntry",null),null!=e){if(this.entry.id=e.id,this.entry.name=e.name,this.entry.type=e.type,this.entry.info=e.info,this.entry.amount=e.amount,this.entry.product=e.product,this.entry.bill_picture=e.bill_picture,null!=e.bill_picture){const t=await ct.storage.from("bill-pictures/"+this.companyData.id).download(e.bill_picture);null!=t.data&&(this.entry.image=await t.data.text(),this.entry.initialImage=this.entry.image),t.error&&console.warn(t.error)}}else this.entry=null;this.$emit("stopEditingEntry",this.entry)},deleteEntry(){this.$emit("deleteEntry",this.entry)},imageInput(){var e=document.getElementById("formFile");if(e.files&&e.files[0]){var t=new FileReader;t.onload=e=>{this.entry.image=e.target.result},t.readAsDataURL(e.files[0])}},async validateEntry(e,t){var i=document.getElementById("entry-name"),a=document.getElementById("entry-type"),s=document.getElementById("entry-amount"),o=document.getElementById("entry-info");if("Verkauf+"==this.entry.type){var n=document.getElementById("entry-product"),r=this.products.find((e=>e.id==n.value));this.entry.product=null!=r?r:this.product,t&&null!=this.entry.product.id&&""!=n.value&&null!=n.value?(this.entry.name=this.entry.product.name,this.entry.amount=this.entry.product.price):(this.entry.name=i.value,this.entry.amount=s.value)}else this.entry.name=i.value,this.entry.amount=s.value;if(this.entry.type=a.value,this.entry.info=o.value,e||this.continuePressed){e&&(i.value=i.value.trim()),e&&(o.value=o.value.trim());var l=!0;i.value.trim().length<3?(i.classList.remove("is-valid"),i.classList.add("is-invalid"),l=!1):(i.classList.remove("is-invalid"),i.classList.add("is-valid")),s.value<-9999||s.value>9999?(s.classList.remove("is-valid"),s.classList.add("is-invalid"),l=!1):(s.classList.remove("is-invalid"),s.classList.add("is-valid")),"Typ"==a.value?(a.classList.remove("is-valid"),a.classList.add("is-invalid"),l=!1):(a.classList.remove("is-invalid"),a.classList.add("is-valid")),this.continuePressed=!0,l&&e&&(this.initialEntry==this.entry?this.stopEditingEntry():(this.failureAlertTitle="Fehler",this.failureAlertInfo="Beim Aktualisieren des Eintrags ist ein Fehler aufgetreten. Versuche es später erneut.",this.successAlertTitle="",""==this.initialEntry.name?this.store.dispatch("addEntry",this.entry):this.store.dispatch("updateEntry",this.entry)))}}}};const Mi=(0,k.Z)(zi,[["render",Fi],["__scopeId","data-v-25e5a016"]]);var Vi=Mi;const Ni=e=>((0,s.dD)("data-v-0d41032a"),e=e(),(0,s.Cn)(),e),Gi={key:0,class:"search-comp col-12 col-md-6 col-xl-4"},Zi={key:0,class:"alias-wrapper"},Wi={class:"alias-suggestions"},Ri={class:"btn btn-light alias-link"},Ki=Ni((()=>(0,s._)("i",{class:"fa-solid fa-arrow-right"},null,-1))),$i={class:"settings"},Hi={key:0,class:"fa-solid fa-arrow-down fa-lg"},Yi={key:1,class:"fa-solid fa-arrow-up fa-lg"},Ji=(0,s.uE)('<option value="" selected data-v-0d41032a>Typ</option><option value="Einnahmen" data-v-0d41032a> Alle Einnahmen </option><option value="Ausgaben" data-v-0d41032a> Alle Ausgaben </option><option value="Verkauf+" data-v-0d41032a> Verkauf </option><option value="Einkauf-" data-v-0d41032a>Einkauf</option><option value="Gehalt-" data-v-0d41032a>Gehalt</option><option value="Miete-" data-v-0d41032a>Miete</option><option value="Steuern-" data-v-0d41032a>Steuern</option><option value="Sonstige Einnahme+" data-v-0d41032a> Sonstige Einnahmen </option><option value="Sonstige Ausgabe-" data-v-0d41032a>Sonstige Ausgaben</option>',10),Qi=[Ji],Xi=(0,s.uE)('<option value="" selected data-v-0d41032a>Kategorie</option><option value="Essen" data-v-0d41032a>Essen</option><option value="Trinken" data-v-0d41032a>Trinken</option><option value="Dienstleistung" data-v-0d41032a>Dienstleistung</option><option value="Gegenstand" data-v-0d41032a>Gegenstand</option><option value="Aktivität" data-v-0d41032a>Aktivität</option><option value="Event" data-v-0d41032a>Event</option><option value="Sonstiges" data-v-0d41032a>Sonstiges</option>',8),ea=[Xi],ta=(0,s.uE)('<option value="created_at" selected data-v-0d41032a>Sortieren</option><option value="amount" data-v-0d41032a>Betrag</option><option value="created_at" data-v-0d41032a>Datum</option><option value="category" data-v-0d41032a>Typ</option><option value="name" data-v-0d41032a>Name</option>',5),ia=[ta],aa=(0,s.uE)('<option value="relevance" selected data-v-0d41032a>Sortieren</option><option value="price" data-v-0d41032a>Preis</option><option value="review" data-v-0d41032a>Bewertung</option><option value="category" data-v-0d41032a>Kategorie</option><option value="name" data-v-0d41032a>Name</option>',5),sa=[aa],oa={key:0,style:{"margin-bottom":"50px"}},na={key:0,class:"empty"},ra={key:1,class:"empty"};function la(e,t,i,o,n,r){const l=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",{class:(0,ut.C_)(["row",{noSearch:i.noSearch,"no-margin":"AccountingEntryTile"==i.element}])},[(0,s._)("div",{class:(0,ut.C_)({"col-md-3 col-xl-4":"ProductTile"==i.element,"col-md-2":"AccountingEntryTile"==i.element})},null,2),i.noSearch?((0,s.wg)(),(0,s.iD)("div",Gi)):((0,s.wg)(),(0,s.iD)("div",{key:1,class:(0,ut.C_)({"col-12 col-md-6 col-xl-4":"ProductTile"==i.element,"col-md-8":"AccountingEntryTile"==i.element})},[(0,s.wy)((0,s._)("input",{class:"search form-control form-control-lg me-2",type:"search",placeholder:"Suchen...","aria-label":"Suchen...","on-":"",onFocus:t[0]||(t[0]=e=>n.focus=!0),onFocusout:t[1]||(t[1]=e=>r.removeFocus()),"onUpdate:modelValue":t[2]||(t[2]=e=>n.searchString=e)},null,544),[[a.nr,n.searchString]]),this.directLinks.length>0&&this.focus?((0,s.wg)(),(0,s.iD)("div",Zi,[(0,s._)("div",Wi,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.directLinks,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e.id,style:{display:"block"}},[(0,s.Wm)(l,{to:e.alias},{default:(0,s.w5)((()=>[(0,s._)("button",Ri,[(0,s.Uk)((0,ut.zw)(e.alias)+" ",1),Ki])])),_:2},1032,["to"])])))),128))])])):(0,s.kq)("",!0)],2)),(0,s._)("div",{class:(0,ut.C_)({"col-md-3 col-xl-4":"ProductTile"==i.element,"col-md-2":"AccountingEntryTile"==i.element})},null,2),(0,s._)("div",{class:(0,ut.C_)({"col-md-3 col-xl-4":"ProductTile"==i.element,"col-md-2":"AccountingEntryTile"==i.element})},null,2),(0,s._)("div",{class:(0,ut.C_)({"col-12 col-md-6 col-xl-4":"ProductTile"==i.element,"col-md-8":"AccountingEntryTile"==i.element})},[(0,s._)("div",$i,[(0,s._)("button",{class:"direction btn btn-outline-secondary",onClick:t[3]||(t[3]=e=>["up"==n.dir?n.dir="down":n.dir="up"])},["up"==n.dir?((0,s.wg)(),(0,s.iD)("i",Hi)):((0,s.wg)(),(0,s.iD)("i",Yi))]),"AccountingEntryTile"==i.element?((0,s.wg)(),(0,s.iD)("select",{key:0,onChange:t[4]||(t[4]=(...e)=>r.entryCategoryChange&&r.entryCategoryChange(...e)),id:"entryCategory",class:"form-select form-select-md mb-3","aria-label":".form-select-lg example"},Qi,32)):((0,s.wg)(),(0,s.iD)("select",{key:1,onChange:t[5]||(t[5]=(...e)=>r.productCategoryChange&&r.productCategoryChange(...e)),id:"productCategory",class:"form-select form-select-md mb-3","aria-label":".form-select-lg example"},ea,32)),"AccountingEntryTile"==i.element?((0,s.wg)(),(0,s.iD)("select",{key:2,onChange:t[6]||(t[6]=(...e)=>r.entrySortChange&&r.entrySortChange(...e)),id:"entrySort",class:"form-select form-select-right form-select-md mb-3","aria-label":".form-select-lg example"},ia,32)):((0,s.wg)(),(0,s.iD)("select",{key:3,onChange:t[7]||(t[7]=(...e)=>r.productSortChange&&r.productSortChange(...e)),id:"productSort",class:"form-select form-select-right form-select-md mb-3","aria-label":".form-select-lg example"},sa,32))])],2)],2),(0,s._)("div",{class:(0,ut.C_)({"product-list":"ProductTile"==i.element,"entry-list":"AccountingEntryTile"==i.element}),ref:"sortableList"},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.sortedShownItems,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e.id},["ProductTile"==i.element?((0,s.wg)(),(0,s.j4)((0,s.LL)(i.element),{key:0,data:e,onDeleteProduct:t[8]||(t[8]=e=>r.deleteProduct(e))},null,40,["data"])):((0,s.wg)(),(0,s.j4)((0,s.LL)(i.element),{data:e,products:i.products,key:e.id,companyData:i.companyData,onDeleteEntry:t[9]||(t[9]=e=>r.deleteEntry(e)),onStopEditingEntry:t[10]||(t[10]=e=>r.stopEditingEntry(e))},null,40,["data","products","companyData"]))])))),128)),((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(2,(e=>(0,s._)("div",{key:e,class:"item"}))),64))],2),0!=n.shownItems.length||i.loading?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",oa,["AccountingEntryTile"==i.element?((0,s.wg)(),(0,s.iD)("h4",na," Es wurden keine Einträge gefunden ")):((0,s.wg)(),(0,s.iD)("h4",ra,"Es wurden keine Produkte gefunden"))]))],64)}const ca=e=>((0,s.dD)("data-v-c4cf3c74"),e=e(),(0,s.Cn)(),e),da={class:"card"},ua={class:"image"},pa={key:0,class:"no-image"},ma=ca((()=>(0,s._)("i",{class:"fa-solid fa-image fa-2xl"},null,-1))),ha=[ma],ga=["src"],ya={class:"info"},fa={class:"row"},va={class:"col col-9"},ba={class:"name"},wa={class:"category"},_a={class:"col col-3"},ka=ca((()=>(0,s._)("i",{class:"fa-solid fa-pen-to-square fa-lg"},null,-1))),Ea=[ka],Ca={class:"description"},Sa={class:"price"},Da={class:"settings"},Ia={key:0,class:"fa-solid fa-truck fa-lg"},Pa={key:1,class:"fa-solid fa-lock fa-lg"};function Ba(e,t,i,a,o,n){const r=(0,s.up)("EditProductOverlay");return(0,s.wg)(),(0,s.iD)(s.HY,null,[o.edit?((0,s.wg)(),(0,s.j4)(r,{key:0,registration:i.registration,data:a.product,onStopEditingProduct:t[0]||(t[0]=e=>n.stopEditingProduct(e)),onDeleteProduct:t[1]||(t[1]=e=>n.deleteProduct(e))},null,8,["registration","data"])):(0,s.kq)("",!0),(0,s._)("div",da,[(0,s._)("div",ua,[null==this.picture?((0,s.wg)(),(0,s.iD)("div",pa,ha)):((0,s.wg)(),(0,s.iD)("img",{key:1,src:this.picture,alt:""},null,8,ga))]),(0,s._)("div",ya,[(0,s._)("div",fa,[(0,s._)("div",va,[(0,s._)("p",ba,(0,ut.zw)(a.product.name),1),(0,s._)("p",wa,(0,ut.zw)(a.product.categories[0]),1)]),(0,s._)("div",_a,[(0,s._)("button",{onClick:t[2]||(t[2]=e=>o.edit=!0),class:"btn btn-primary"},Ea)])]),(0,s._)("p",Ca,(0,ut.zw)(a.product.info),1),(0,s._)("p",Sa,(0,ut.zw)(a.product.price)+" $",1),(0,s._)("div",Da,[a.product.delivery?((0,s.wg)(),(0,s.iD)("i",Ia)):(0,s.kq)("",!0),a.product.public?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("i",Pa))])])])],64)}const xa=e=>((0,s.dD)("data-v-bf11f640"),e=e(),(0,s.Cn)(),e),Aa={class:"overlay"},Ta={class:"card"},La={class:"card-header"},qa=xa((()=>(0,s._)("h4",{class:"card-title"},"Produkt",-1))),Oa={class:"card-body scroll"},Ua={class:"image"},Fa={key:0,class:"no-image"},ja=xa((()=>(0,s._)("i",{class:"fa-solid fa-image fa-2xl"},null,-1))),za=[ja],Ma=["src"],Va={key:0,style:{"font-weight":"300","font-size":"0.9rem"}},Na={class:"needs-validation",novalidate:""},Ga={class:"input-group mb-3"},Za=xa((()=>(0,s._)("span",{class:"input-group-text"},[(0,s._)("i",{class:"fa-solid fa-box-open"})],-1))),Wa=["value"],Ra={class:"input-group mb-3"},Ka=xa((()=>(0,s._)("span",{class:"input-group-text"},[(0,s._)("i",{class:"fa-solid fa-dollar-sign"})],-1))),$a=["value"],Ha={class:"input-group mb-3"},Ya=xa((()=>(0,s._)("span",{class:"input-group-text"},[(0,s._)("i",{class:"fa-solid fa-list"})],-1))),Ja=["value"],Qa=(0,s.uE)('<option value="" selected data-v-bf11f640>Kategorie</option><option value="Essen" data-v-bf11f640>Essen</option><option value="Trinken" data-v-bf11f640>Trinken</option><option value="Dienstleistung" data-v-bf11f640>Dienstleistung</option><option value="Gegenstand" data-v-bf11f640>Gegenstand</option><option value="Aktivität" data-v-bf11f640> Aktivität </option><option value="Event" data-v-bf11f640> Event </option><option value="Sonstiges" data-v-bf11f640> Sonstiges </option>',8),Xa=[Qa],es={class:"input-group mb-3"},ts=xa((()=>(0,s._)("span",{class:"input-group-text"},[(0,s._)("i",{class:"fa-solid fa-circle-info"})],-1))),is=["value"],as={class:"switches"},ss={class:"form-check form-switch"},os=["checked"],ns=xa((()=>(0,s._)("label",{class:"form-check-label",for:"flexSwitchCheckChecked"},"Lieferbar",-1))),rs={class:"form-check form-switch"},ls=["checked"],cs=xa((()=>(0,s._)("label",{class:"form-check-label",for:"flexSwitchCheckDefault"},"Privat (nur für Buchhaltung)",-1))),ds={class:"card-footer"},us={key:1,class:"confirm"},ps=xa((()=>(0,s._)("i",{class:"fa-solid fa-check fa-lg"},null,-1))),ms=[ps],hs=xa((()=>(0,s._)("i",{class:"fa-solid fa-xmark fa-lg"},null,-1))),gs=[hs];function ys(e,t,i,a,o,n){const r=(0,s.up)("AlertPopup");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(r,{title:this.alertTitle,info:this.alertInfo},null,8,["title","info"]),(0,s._)("div",Aa,[(0,s._)("div",Ta,[(0,s._)("div",La,[(0,s._)("div",null,[qa,(0,s._)("button",{type:"button",class:"btn-close","aria-label":"Close",onClick:t[0]||(t[0]=e=>n.stopEditingProduct())})])]),(0,s._)("div",Oa,[(0,s._)("div",Ua,[null==a.product.image?((0,s.wg)(),(0,s.iD)("div",Fa,za)):((0,s.wg)(),(0,s.iD)("img",{key:1,src:this.product.image,alt:"Unternehmen Bild",id:"productImage"},null,8,Ma))]),(0,s._)("input",{class:"form-control form-control-sm col-7",type:"file",id:"formFile",accept:"image/*",onChange:t[1]||(t[1]=e=>n.imageInput())},null,32),null==a.product.image?((0,s.wg)(),(0,s.iD)("p",Va,"Füge ein Bild hinzu, welches dein Produkt repräsentiert. (Optimales Format 1:1)")):(0,s.kq)("",!0),(0,s._)("form",Na,[(0,s._)("div",Ga,[Za,(0,s._)("input",{type:"text",id:"product-name",class:"form-control",onInput:t[2]||(t[2]=e=>n.validateProduct(!1)),placeholder:"Name",value:a.product.name,required:""},null,40,Wa)]),(0,s._)("div",Ra,[Ka,(0,s._)("input",{type:"number",id:"product-price",class:"form-control",onInput:t[3]||(t[3]=e=>n.validateProduct(!1)),placeholder:"Preis",value:a.product.price,required:""},null,40,$a)]),(0,s._)("div",Ha,[Ya,(0,s._)("select",{class:"form-select",id:"product-category","aria-label":"Default select example",value:a.product.categories[0],onChange:t[4]||(t[4]=e=>n.validateProduct(!1))},Xa,40,Ja)]),(0,s._)("div",es,[ts,(0,s._)("textarea",{type:"text",id:"product-info",class:"form-control",onInput:t[5]||(t[5]=e=>n.validateProduct(!1)),placeholder:"Beschreibung",required:"",maxlength:"200",style:{resize:"none"},rows:"5",cols:"50",value:a.product.info},null,40,is)]),(0,s._)("div",as,[(0,s._)("div",ss,[(0,s._)("input",{onClick:t[6]||(t[6]=(...e)=>n.switchDelivery&&n.switchDelivery(...e)),checked:a.product.delivery,class:"form-check-input",type:"checkbox",role:"switch",id:"deliverySwitch"},null,8,os),ns]),(0,s._)("div",rs,[(0,s._)("input",{onClick:t[7]||(t[7]=(...e)=>n.switchPrivate&&n.switchPrivate(...e)),checked:!a.product.public,class:"form-check-input",type:"checkbox",role:"switch",id:"privateSwitch"},null,8,ls),cs])])])]),(0,s._)("div",ds,[(0,s._)("button",{class:"btn btn-primary save-button",onClick:t[8]||(t[8]=e=>n.validateProduct(!0))},"Speichern"),this.delete||""==a.initialProduct.name?this.delete&&""!=a.initialProduct.name?((0,s.wg)(),(0,s.iD)("div",us,[(0,s._)("button",{class:"btn btn-primary confirm-button",onClick:t[10]||(t[10]=e=>n.deleteProduct())},ms),(0,s._)("button",{class:"btn btn-danger confirm-button",onClick:t[11]||(t[11]=e=>this.delete=!1)},gs)])):(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("button",{key:0,class:"btn btn-danger delete-button",onClick:t[9]||(t[9]=e=>this.delete=!0)},"Löschen"))])])])],64)}var fs={name:"EditProductOverlay",props:["data","edit","registration"],components:{AlertPopup:kt},emits:["stopEditingProduct","deleteProduct"],data(){return{continuePressed:!1,alertTitle:"",alertInfo:"",successAlertTitle:"Erfolgreich",successAlertInfo:"Aktion wurde erfolgreich durchgeführt",failureAlertTitle:"Fehler",failureAlertInfo:"Es ist ein Fehler aufgetreten!",delete:!1}},setup(){var e=(0,dt.qj)({id:null,name:"",info:"",categories:[],price:"",imageBefore:null,image:null,delivery:!0,public:!0,product_picture:""}),t=(0,dt.qj)({id:null,name:"",info:"",categories:[],price:"",imageBefore:null,image:null,delivery:!0,public:!0,product_picture:""});const i=(0,V.oR)();return{store:i,product:e,initialProduct:t}},mounted(){null!=this.data?(this.product.id=this.data.id,this.product.name=this.data.name,this.product.categories=this.data.categories,this.product.info=this.data.info,this.product.price=this.data.price,this.product.imageBefore=this.data.image,this.product.image=this.data.image,this.product.delivery=this.data.delivery,this.product.public=this.data.public,this.product.product_picture=this.data.product_picture,this.initialProduct.id=this.data.id,this.initialProduct.name=this.data.name,this.initialProduct.categories=this.data.categories,this.initialProduct.info=this.data.info,this.initialProduct.price=this.data.price,this.initialProduct.imageBefore=this.data.image,this.initialProduct.image=this.data.image,this.initialProduct.delivery=this.data.delivery,this.initialProduct.public=this.data.public,this.initialProduct.product_picture=this.data.product_picture):(this.product.id=(0,ji.Z)(),this.initialProduct.id=this.product.id)},computed:{...(0,V.Se)(["getState"])},watch:{getState(e){var t=document.getElementsByClassName("spinner"),i=document.getElementsByClassName("loading-button");if("loading"==e)Array.from(t).forEach((e=>{e.style.visibility="visible",e.style.position="relative"})),Array.from(i).forEach((e=>{e.style.visibility="hidden",e.style.position="absolute"}));else if("success"==e)Array.from(t).forEach((e=>{e.style.visibility="hidden",e.style.position="absolute"})),Array.from(i).forEach((e=>{e.style.visibility="visible",e.style.position="relative"})),this.alertTitle=this.successAlertTitle,this.alertInfo=this.successAlertInfo,""!=this.alertTitle&&(a=new x.Modal(document.getElementById("alertModal"),{}),a.show()),this.stopEditingProduct();else if(Array.from(t).forEach((e=>{e.style.visibility="hidden",e.style.position="absolute"})),Array.from(i).forEach((e=>{e.style.visibility="visible",e.style.position="relative"})),this.alertTitle=this.failureAlertTitle,this.alertInfo=this.failureAlertInfo,""!=this.alertTitle){var a=new x.Modal(document.getElementById("alertModal"),{});a.show()}}},methods:{async stopEditingProduct(){if(!this.registration){const e=this.store.getters.getCurrentProduct;if(this.store.commit("setCurrentProduct",null),null!=e){if(this.product.id=e.id,this.product.name=e.name,this.product.categories=e.categories,this.product.info=e.info,this.product.price=e.price,this.product.delivery=e.delivery,this.product.public=e.public,this.product.product_picture=e.product_picture,null!=e.product_picture){const t=await ct.storage.from("public/products-pictures").download(e.product_picture);null!=t.data&&(this.product.image=await t.data.text(),this.product.initialImage=this.product.image),t.error&&console.warn(t.error)}}else this.product=null}this.$emit("stopEditingProduct",this.product)},switchDelivery(){this.product.delivery=!this.product.delivery,this.product.public=!!this.product.delivery||this.product.public},switchPrivate(){this.product.public=!this.product.public,this.product.delivery=!!this.product.public&&this.product.delivery},deleteProduct(){this.$emit("deleteProduct",this.product)},imageInput(){var e=document.getElementById("formFile");if(e.files&&e.files[0]){var t=new FileReader;t.onload=e=>{this.product.image=e.target.result},t.readAsDataURL(e.files[0])}},async validateProduct(e){var t=document.getElementById("product-name"),i=document.getElementById("product-price"),a=document.getElementById("product-category"),s=document.getElementById("product-info");if(this.product.name=t.value,this.product.price=i.value,this.product.info=s.value,this.product.categories=[a.value],e||this.continuePressed){e&&(t.value=t.value.trim()),e&&(s.value=s.value.trim());var o=!0;t.value.trim().length<3?(t.classList.remove("is-valid"),t.classList.add("is-invalid"),o=!1):(t.classList.remove("is-invalid"),t.classList.add("is-valid")),i.value<0||i.value>9999?(i.classList.remove("is-valid"),i.classList.add("is-invalid"),o=!1):(i.classList.remove("is-invalid"),i.classList.add("is-valid")),"Kategorie"==a.value?(a.classList.remove("is-valid"),a.classList.add("is-invalid"),o=!1):(a.classList.remove("is-invalid"),a.classList.add("is-valid")),s.value.trim().length<5?(s.classList.remove("is-valid"),s.classList.add("is-invalid"),o=!1):(s.classList.remove("is-invalid"),s.classList.add("is-valid")),this.continuePressed=!0,o&&e&&(this.initialProduct==this.product?this.stopEditingProduct():(this.failureAlertTitle="Fehler",this.failureAlertInfo="Beim Aktualisieren des Produkts ist ein Fehler aufgetreten. Versuche es später erneut.",this.successAlertTitle="",this.registration?this.stopEditingProduct():""==this.initialProduct.name?this.store.dispatch("addProduct",this.product):this.store.dispatch("updateProduct",this.product)))}}}};const vs=(0,k.Z)(fs,[["render",ys],["__scopeId","data-v-bf11f640"]]);var bs=vs,ws={name:"ProductTile",props:["data","registration"],components:{EditProductOverlay:bs},emits:["deleteProduct","editProduct"],data(){return{edit:!1,picture:null}},setup(){var e=(0,dt.qj)({id:null,name:"",info:"",categories:[],price:"",imageBefore:null,image:null,delivery:!0,public:!0,product_picture:""});return{product:e}},async mounted(){if(null!=this.data)if(this.product.id=this.data.id,this.product.name=this.data.name,this.product.categories=this.data.categories,this.product.info=this.data.info,this.product.price=this.data.price,this.product.delivery=this.data.delivery,this.product.public=this.data.public,this.product.product_picture=this.data.product_picture,this.registration)this.product.image=this.data.image,this.product.imageBefore=this.data.image,this.picture=this.data.image;else if(null!=this.data.product_picture){const e=await ct.storage.from("public/products-pictures").download(this.data.product_picture);null!=e.data&&(this.product.image=await e.data.text(),this.product.imageBefore=this.product.image,this.picture=this.product.image),e.error&&console.warn(e.error)}else null!=this.data.image&&(this.product.image=this.data.image,this.product.imageBefore=this.data.image,this.picture=this.data.image)},methods:{stopEditingProduct(e){this.edit=!1,null!=e&&(this.product=e,this.picture=e.image,this.registration&&this.$emit("editProduct",e))},deleteProduct(e){this.edit=!1,this.$emit("deleteProduct",e)}}};const _s=(0,k.Z)(ws,[["render",Ba],["__scopeId","data-v-c4cf3c74"]]);var ks=_s;const Es={class:"type"},Cs={class:"input-group-text"},Ss={key:0,class:"fa-solid fa-cart-shopping fa-lg"},Ds={key:1,class:"fa-solid fa-house fa-lg"},Is={key:2,class:"fa-solid fa-user fa-lg"},Ps={key:3,class:"fa-solid fa-gavel fa-lg"},Bs={key:4,class:"fa-solid fa-box-open fa-lg"},xs={key:5,class:"fa-solid fa-dollar-sign fa-lg"},As={key:6,class:"fa-solid fa-file"},Ts={class:"name"};function Ls(e,t,i,a,o,n){const r=(0,s.up)("EditAccountingEntryOverlay");return(0,s.wg)(),(0,s.iD)(s.HY,null,[o.edit?((0,s.wg)(),(0,s.j4)(r,{key:0,data:a.entry,companyData:i.companyData,products:i.products,onStopEditingEntry:t[0]||(t[0]=e=>n.stopEditingEntry(e)),onDeleteEntry:t[1]||(t[1]=e=>n.deleteEntry(e))},null,8,["data","companyData","products"])):(0,s.kq)("",!0),(0,s._)("div",{class:"card",onClick:t[2]||(t[2]=e=>o.edit=!0)},[(0,s._)("div",Es,[(0,s._)("span",Cs,["Einkauf-"==a.entry.type?((0,s.wg)(),(0,s.iD)("i",Ss)):"Miete-"==a.entry.type?((0,s.wg)(),(0,s.iD)("i",Ds)):"Gehalt-"==a.entry.type?((0,s.wg)(),(0,s.iD)("i",Is)):"Steuern-"==a.entry.type?((0,s.wg)(),(0,s.iD)("i",Ps)):"Verkauf+"==a.entry.type?((0,s.wg)(),(0,s.iD)("i",Bs)):((0,s.wg)(),(0,s.iD)("i",xs)),null!=a.entry.bill_picture?((0,s.wg)(),(0,s.iD)("i",As)):(0,s.kq)("",!0)])]),(0,s._)("p",Ts,(0,ut.zw)(a.entry.name),1),(0,s._)("p",{class:(0,ut.C_)(["price",{income:a.entry.amount>0,expense:a.entry.amount<0}])},(0,ut.zw)(a.entry.amount>0?"+":"")+(0,ut.zw)(a.entry.amount)+" $",3)])],64)}var qs={name:"AccountingEntryTile",props:["data","products","companyData"],components:{EditAccountingEntryOverlay:Vi},emits:["deleteEntry","stopEditingEntry"],data(){return{edit:!1,picture:null}},setup(){var e=(0,dt.qj)({id:null,name:"",type:"",info:"",amount:"",product:null,created_at:"",imageBefore:null,image:null,bill_picture:""});const t=(0,V.oR)();return{entry:e,store:t}},async mounted(){if(null!=this.data)if(this.entry.id=this.data.id,this.entry.name=this.data.name,this.entry.type=this.data.type,this.entry.info=this.data.info,this.entry.amount=this.data.amount,this.entry.bill_picture=this.data.bill_picture,null!=this.data.bill_picture){const e=await ct.storage.from("bill-pictures/"+this.companyData.id).download(this.data.bill_picture);null!=e.data&&(this.entry.image=await e.data.text(),this.entry.imageBefore=this.entry.image,this.picture=this.entry.image),e.error&&console.warn(e.error)}else null!=this.data.image&&(this.entry.image=this.data.image,this.entry.imageBefore=this.entry.image,this.picture=this.data.image)},methods:{stopEditingEntry(e){this.edit=!1,null!=e&&(this.entry=e,this.picture=e.image,this.$emit("stopEditingEntry",e))},deleteEntry(e){this.edit=!1,this.$emit("deleteEntry",e)}}};const Os=(0,k.Z)(qs,[["render",Ls],["__scopeId","data-v-b78d7160"]]);var Us=Os,Fs={name:"SortableList",emits:["deleteProduct","deleteEntry","stopEditingEntry"],data(){return{categories:[],chosenCategories:[],searchString:"",shownItems:[],sortedShownItems:[],sortBy:"AccountingEntryTile"==this.element?"created_at":"",dir:"up",directLinks:[],focus:!1}},props:["items","element","loading","noSearch","sortByCategories","showCategory","products","companyData"],methods:{sort:function(){if(this.sortedShownItems=this.shownItems,""!=this.sortBy){if("category"==this.sortBy){var e=[];if("ProductTile"==this.element){e=["Essen","Trinken","Gegenstand","Dienstleistung","Aktivität","Event","Sonstiges"];for(var t=0;t<this.sortedShownItems.length;t++)this.sortedShownItems[t].category=e.indexOf(this.sortedShownItems[t].categories[0])}else{e=["Verkauf+","Einkauf-","Gehalt-","Miete-","Steuern-","Sonstige Einnahmen+","Sonstige Ausgaben-"];for(var i=0;i<this.sortedShownItems.length;i++)this.sortedShownItems[i].category=e.indexOf(this.sortedShownItems[i].type)}}else if("amount"==this.sortBy)return this.sortedShownItems.sort(((e,t)=>"string"==typeof e[this.sortBy]&&"string"==typeof t[this.sortBy]?e[this.sortBy].localeCompare(t[this.sortBy]):Math.abs(e[this.sortBy])>Math.abs(t[this.sortBy])?1:Math.abs(e[this.sortBy])<Math.abs(t[this.sortBy])?-1:0)),void("down"==this.dir&&this.sortedShownItems.reverse());this.sortedShownItems.sort(((e,t)=>"string"==typeof e[this.sortBy]&&"string"==typeof t[this.sortBy]?e[this.sortBy].localeCompare(t[this.sortBy]):e[this.sortBy]>t[this.sortBy]?1:e[this.sortBy]<t[this.sortBy]?-1:0)),("up"==this.dir&&"created_at"==this.sortBy||"down"==this.dir&&"created_at"!=this.sortBy)&&this.sortedShownItems.reverse()}else this.shuffleArray(this.sortedShownItems)},searchForString:function(e,t){if(e.startsWith("/")&&(e=e.substring(1)),null==t)return 0;let i=0;if("object"==typeof t){if(!(t instanceof Array)){let e=[],i=[];i="AccountingEntryTile"==this.element?["name","type","info"]:["name","company_name","info"],i.forEach((i=>e.push(t[i]))),t=e}for(let a=0;a<t.length;a++)i+=this.searchForString(e,t[a]);return i}if("string"!=typeof t)return 0;let a=t.match(new RegExp(e,"gi"));return null==a?0:a.length},generateShownItems:function(){let e=[];for(let t=0;t<this.items.length;t++){let i=this.items[t],a=!0;if(0==this.searchForString(this.searchString,i))a=!1;else if("AccountingEntryTile"==this.element)a=!!this.chosenCategories.includes(i.type)||(!(!this.chosenCategories.includes("Einnahmen")||!i.type.includes("+"))||(!(!this.chosenCategories.includes("Ausgaben")||!i.type.includes("-"))||0==this.chosenCategories.length));else if(null==i.categories&&0!=this.chosenCategories.length)a=!1;else for(let e=0;e<this.chosenCategories.length;e++)i.categories.includes(this.chosenCategories[e])||(a=!1),"Gastronomie & Dienstleistung"!=i.categories[0]||"Gastronomie"!=this.chosenCategories[e]&&"Dienstleistung"!=this.chosenCategories[e]||(a=!0);a&&e.push(i)}e!=this.shownItems&&(this.shownItems=e,this.sort())},generateCategories:function(){for(let e=0;e<this.items.length;e++){let t=this.items[e];if(null!=t.categories)for(let e=0;e<t.categories.length;e++){let i=t.categories[e];this.categories.includes(i)||this.categories.push(i)}}},entryCategoryChange(){const e=document.getElementById("entryCategory"),t=e.value;this.chosenCategories=""==t?[]:[t]},productCategoryChange(){const e=document.getElementById("productCategory"),t=e.value;this.chosenCategories=""==t?[]:[t]},entrySortChange(){const e=document.getElementById("entrySort"),t=e.value;this.sortBy=t,console.log(t)},productSortChange(){const e=document.getElementById("productSort"),t=e.value;this.sortBy=t},aliasRoute(e){Hn.addRoute({path:"/"+e}),Hn.forward(),console.log("/"+e)},removeFocus(){setTimeout(function(){this.focus=!1}.bind(this),200)},shuffleArray(e){for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}},deleteProduct(e){this.$emit("deleteProduct",e)},deleteEntry(e){this.$emit("deleteEntry",e)},stopEditingEntry(e){this.$emit("stopEditingEntry",e)}},mounted(){this.sortByCategories&&(this.sortBy="category"),this.generateCategories(),this.generateShownItems()},watch:{items:function(){this.generateCategories(),this.generateShownItems()},element:function(){this.generateShownItems()},searchString:function(){if(this.generateShownItems(),this.directLinks=[],"CompanyTile"==this.element&&this.searchString.startsWith("/"))for(let e=0;e<this.items.length;e++)void 0!==this.items[e].alias&&this.items[e].alias.startsWith(this.searchString.substring(1))&&this.directLinks.push(this.items[e])},dir:function(){this.generateShownItems()},sortBy:function(){this.generateShownItems()},chosenCategories:function(){this.generateShownItems()}},components:{ProductTile:ks,AccountingEntryTile:Us}};const js=(0,k.Z)(Fs,[["render",la],["__scopeId","data-v-0d41032a"]]);var zs=js,Ms=i(1809),Vs={name:"AccountingView",props:["companyData"],components:{TitleDiv:ii,EditAccountingEntryOverlay:Vi,SortableList:zs},setup(){const e=(0,V.oR)();return{store:e}},mounted(){window.jQuery=window.$=i(9755),window.Popper=i(4599),i(1016),window.$("body").tooltip({selector:'[data-bs-toggle="tooltip"]'})},data(){return{entries:[],products:[],expenses:0,revenue:0,profit:0,euroProfit:0,newEntry:!1,listKey:0,key:0,totalChart:null,typeChart:null}},async created(){{const{data:e,error:t}=await ct.from("products").select().eq("company_id",this.companyData.id);if(t)throw t;this.products=e.sort(((e,t)=>e.name.localeCompare(t.name)))}const{data:e,error:t}=await ct.from("accounting").select().eq("company_id",this.companyData.id);if(t)throw t;this.entries=e,this.calculateProfit(),this.updateGraphs()},methods:{deleteEntry(e){this.newEntry=!1;var t=this.entries.findIndex((t=>t.id==e.id));this.entries.splice(t,1),this.store.dispatch("deleteEntry",e),this.calculateProfit(),this.updateGraphs(),this.key++},stopEditingEntry(e){if(this.newEntry=!1,null!=e){const t=this.entries.findIndex((t=>t.id==e.id));console.log(this.entries),console.log(t),-1==t?this.entries.push(e):(this.entries[t].type=e.type,this.entries[t].product=e.product,this.entries[t].name=e.name,this.entries[t].amount=e.amount,this.entries[t].info=e.info,this.entries[t].bill_picture=e.bill_picture)}this.calculateProfit(),this.updateGraphs(),this.key++},addEntry(){this.newEntry=!0},calculateProfit(){this.revenue=0,this.expenses=0,this.entries.forEach((e=>{e.amount>0?this.revenue+=e.amount:this.expenses+=Math.abs(e.amount)})),this.profit=this.revenue-this.expenses,this.euroProfit=this.profit>0?.08*this.profit:.1*this.profit,this.euroProfit=this.euroProfit.toFixed(2)},updateGraphs(){this.updateTotalGraph(),this.updateTypeGraph()},updateTotalGraph(){const e={type:"bar",label:"Einnahmen",data:[],backgroundColor:"rgba(0, 128, 0, 0.2)",borderColor:"rgba(0, 128, 0, 1)",order:2,borderSkipped:!1,borderWidth:1},t={type:"bar",label:"Ausgaben",data:[],backgroundColor:"rgba(255, 0, 0, 0.2)",borderColor:"rgba(255, 0, 0, 1)",order:3,borderSkipped:!1,borderWidth:1},i={type:"line",label:"Gewinn / Verlust",data:[],backgroundColor:"rgba(13, 110, 253, 1)",borderColor:"rgba(13, 110, 253, 1)",order:1};var a=[];this.entries.forEach((e=>{a.push(e)})),a.sort(((e,t)=>e.created_at.localeCompare(t.created_at)));const s=[];a.forEach((a=>{var o;s.includes(a.created_at.split("T")[0])?o=s.indexOf(a.created_at.split("T")[0]):(s.push(a.created_at.split("T")[0]),o=s.length-1,e.data.push(0),t.data.push(0),0==o?i.data.push(0):i.data[o]=i.data[o-1]),a.amount>0?e.data[o]+=a.amount:t.data[o]+=a.amount,i.data[o]+=a.amount})),null!=this.totalChart&&this.totalChart.destroy(),this.totalChart=null;const o=document.getElementById("total-chart");this.totalChart=new Ms.kL(o,{data:{labels:s,datasets:[e,t,i]},options:{scales:{x:{stacked:!0},y:{beginAtZero:!1}},responsive:!0}})},updateTypeGraph(){var e=[];this.entries.forEach((t=>{e.push(t)})),e.sort(((e,t)=>e.type[e.type.length-1].localeCompare(t.type[t.type.length-1])));const t={type:"bar",data:[],backgroundColor:[],borderColor:[],order:1,borderSkipped:!0,borderWidth:1},i=[];e.forEach((e=>{var a;i.includes(e.type.replace("+","").replace("-",""))?a=i.indexOf(e.type.replace("+","").replace("-","")):(i.push(e.type.replace("+","").replace("-","")),a=i.length-1,t.data.push(0),e.amount>0?(t.backgroundColor.push("rgba(0, 128, 0, 0.2)"),t.borderColor.push("rgba(0, 128, 0, 1)")):(t.backgroundColor.push("rgba(255, 0, 0, 0.2)"),t.borderColor.push("rgba(255, 0, 0, 1)"))),t.data[a]+=e.amount}));var a=i.indexOf("Sonstige Einnahme");-1!=a&&(i[a]="Sonst. Einn."),a=i.indexOf("Sonstige Ausgabe"),-1!=a&&(i[a]="Sonst. Ausg."),null!=this.typeChart&&this.typeChart.destroy(),this.typeChart=null;const s=document.getElementById("type-chart");this.typeChart=new Ms.kL(s,{data:{labels:i,datasets:[t]},options:{scales:{y:{beginAtZero:!1}},responsive:!0,plugins:{legend:{display:!1}}}})}}};const Ns=(0,k.Z)(Vs,[["render",Ht],["__scopeId","data-v-bbfd3550"]]);var Gs=Ns;function Zs(e,t,i,a,o,n){const r=(0,s.up)("EditProductOverlay"),l=(0,s.up)("TitleDiv"),c=(0,s.up)("SortableList");return(0,s.wg)(),(0,s.iD)(s.HY,null,[o.newProduct?((0,s.wg)(),(0,s.j4)(r,{key:0,registration:!1,onStopEditingProduct:t[0]||(t[0]=e=>n.stopEditingProduct(e)),onDeleteProduct:t[1]||(t[1]=e=>n.deleteProduct())})):(0,s.kq)("",!0),(0,s.Wm)(l,{title:"Produkte"}),(0,s._)("button",{class:"btn btn-primary mb-4 add-product",onClick:t[2]||(t[2]=e=>n.addProduct())}," Produkt hinzufügen "),o.products.length>0?((0,s.wg)(),(0,s.j4)(c,{items:o.products,key:o.key,"sort-by-categories":"true",element:"ProductTile",onDeleteProduct:t[3]||(t[3]=e=>n.deleteProduct(e))},null,8,["items"])):(0,s.kq)("",!0)],64)}var Ws={name:"ProductView",props:["companyData"],components:{TitleDiv:ii,EditProductOverlay:bs,SortableList:zs},setup(){const e=(0,V.oR)();return{store:e}},data(){return{products:[],newProduct:!1,key:0}},async created(){const{data:e,error:t}=await ct.from("products").select().eq("company_id",this.companyData.id);if(t)throw t;this.products=e.sort(((e,t)=>e.name.localeCompare(t.name)))},methods:{deleteProduct(e){this.newProduct=!1,console.log("test");var t=this.products.findIndex((t=>t.id==e.id));this.products.splice(t,1),this.key++,this.store.dispatch("deleteProduct",e)},stopEditingProduct(e){this.newProduct=!1,console.log("test"),null!=e&&(this.products.push(e),this.key++)},addProduct(){this.newProduct=!0}}};const Rs=(0,k.Z)(Ws,[["render",Zs],["__scopeId","data-v-48467634"]]);var Ks=Rs,$s={name:"CompanyDetailView",props:["companyuuid"],components:{AlertPopup:kt,AccountingView:Gs,ProductView:Ks},data(){return{company:void 0,page:0,isCompanyEditing:!1,isEmployeesEditing:!1,saveCompanyPressed:!1,saveEmployeesPressed:!1,employees:[],alertTitle:"",alertInfo:"",successAlertTitle:"Erfolgreich",successAlertInfo:"Aktion wurde erfolgreich durchgeführt",failureAlertTitle:"Fehler",failureAlertInfo:"Es ist ein Fehler aufgetreten!"}},computed:{...(0,V.Se)(["getState"])},setup(){const e=(0,V.oR)(),t=(0,s.Fl)((()=>e.state.user)),i=(0,dt.qj)({name:"",location:"",category:"Kategorie",info:"",employees:[""],image:null,unchangedImage:null,verified:null});return{store:e,userData:t,form:i}},watch:{getState(e){var t=document.getElementsByClassName("spinner"),i=document.getElementsByClassName("loading-button");if("loading"==e)Array.from(t).forEach((e=>{e.style.visibility="visible",e.style.position="relative"})),Array.from(i).forEach((e=>{e.style.visibility="hidden",e.style.position="absolute"}));else if("success"==e){if(Array.from(t).forEach((e=>{e.style.visibility="hidden",e.style.position="absolute"})),Array.from(i).forEach((e=>{e.style.visibility="visible",e.style.position="relative"})),this.alertTitle=this.successAlertTitle,this.alertInfo=this.successAlertInfo,""==this.alertTitle)return;a=new x.Modal(document.getElementById("alertModal"),{}),a.show()}else{if(Array.from(t).forEach((e=>{e.style.visibility="hidden",e.style.position="absolute"})),Array.from(i).forEach((e=>{e.style.visibility="visible",e.style.position="relative"})),this.alertTitle=this.failureAlertTitle,this.alertInfo=this.failureAlertInfo,""==this.alertTitle)return;var a=new x.Modal(document.getElementById("alertModal"),{});a.show()}}},async mounted(){if(this.$route.params.companyalias){const{data:e,error:t}=await ct.from("companies").select().eq("alias",this.$route.params.companyalias);if(null!=t&&console.log(t),null===e||0===e.length)return void(this.company=null);if(this.company=e[0],this.employees=this.company.employees,null!=this.company.header_picture){const e=await ct.storage.from("public/sellers-headings").download(this.company.header_picture);null!=e.data&&(this.form.image=await e.data.text(),this.form.unchangedImage=await e.data.text()),e.error&&console.warn(e.error)}}},methods:{imageInput(){var e=document.getElementById("formFile");if(e.files&&e.files[0]){var t=new FileReader;t.onload=e=>{this.form.image=e.target.result},t.readAsDataURL(e.files[0])}},addEmployee(){var e=document.getElementsByClassName("employees-mail"),t=0;Array.from(e).forEach((e=>{this.employees[t]=e.value,e.classList.remove("is-valid"),e.classList.remove("is-invalid"),t++})),this.employees.push("")},cancelChanges(){this.cancelCompanyChange()},editCompany(){this.isCompanyEditing=!0;var e=document.getElementById("company-name"),t=document.getElementById("company-location"),i=document.getElementById("company-category"),a=document.getElementById("company-info"),s=document.getElementById("company-verified");e.disabled=!1,t.disabled=!1,i.disabled=!1,a.disabled=!1,s.disabled=!1},editEmployees(){this.isEmployeesEditing=!0;var e=document.getElementsByClassName("employees-mail");Array.from(e).forEach((e=>{e.disabled=!1}))},async validateCompanyChange(e){if(e||this.saveCompanyPressed){var t=document.getElementById("company-name"),i=document.getElementById("company-location"),a=document.getElementById("company-category"),s=document.getElementById("company-info"),o=document.getElementById("company-verified");e&&(t.value=t.value.trim()),e&&(i.value=i.value.trim()),e&&(s.value=s.value.trim());var n=!0;if(t.value.trim().length<3?(t.classList.remove("is-valid"),t.classList.add("is-invalid"),n=!1):(t.classList.remove("is-invalid"),t.classList.add("is-valid")),i.value.trim().length<3||i.value.trim().length>40?(i.classList.remove("is-valid"),i.classList.add("is-invalid"),n=!1):(i.classList.remove("is-invalid"),i.classList.add("is-valid")),"Kategorie"==a.value?(a.classList.remove("is-valid"),a.classList.add("is-invalid"),n=!1):(a.classList.remove("is-invalid"),a.classList.add("is-valid")),s.value.trim().length<10?(s.classList.remove("is-valid"),s.classList.add("is-invalid"),n=!1):(s.classList.remove("is-invalid"),s.classList.add("is-valid")),this.saveCompanyPressed=!0,n&&e){if(this.store.commit("setState","loading"),t.value.replace(/\s/g,"").toLowerCase()!=this.company.alias){const{data:e,error:n}=await ct.from("companies").select().eq("alias",t.value.replace(/\s/g,"").toLowerCase());if(n||null!=e[0])return t.classList.remove("is-valid"),t.classList.add("is-invalid"),this.form.name=t.value,this.form.location=i.value,this.form.category=a.value,this.form.info=s.value,this.form.verified=o.checked,this.failureAlertTitle="Name schon vergeben",this.failureAlertInfo="Es gibt bereits ein Unternehmen mit diesem Namen. Bitte wähle einen anderen!",void this.store.commit("setState","failure")}this.form.name=t.value,this.form.location=i.value,this.form.info=s.value,this.form.category=a.value,this.form.verified=o.checked,this.saveCompany()}}},validateEmployeesChange(e,t){if(e||this.saveEmployeesPressed){var i=document.getElementsByClassName("employees-mail"),a=i[t].getAttribute("data-regex"),s=!0;e?Array.from(i).forEach((e=>{e.value.match(a)?(e.classList.remove("is-invalid"),e.classList.add("is-valid")):(e.classList.remove("is-valid"),e.classList.add("is-invalid"),s=!1)})):i[t].value.match(a)?(i[t].classList.remove("is-invalid"),i[t].classList.add("is-valid")):(i[t].classList.remove("is-valid"),i[t].classList.add("is-invalid"),s=!1),this.saveEmployeesPressed=!0,s&&e&&this.saveEmployees()}},async saveCompany(){try{this.isCompanyEditing=!1,this.saveCompanyPressed=!1;var e=document.getElementById("company-name"),t=document.getElementById("company-location"),i=document.getElementById("company-category"),a=document.getElementById("company-info");const{data:n,error:r}=await ct.from("companies").update({alias:this.form.name.replace(/\s/g,"").toLowerCase(),name:this.form.name,categories:[this.form.category],location:this.form.location,info:this.form.info,verified:this.form.verified}).eq("id",this.company.id).select();if(console.log(n),console.log(r),r)throw r;if(null!=this.form.image&&this.form.image!=this.form.unchangedImage){{const{error:e}=await ct.storage.from("sellers-headings").remove([n[0].header_picture]);if(e)throw e}var s=this.form.image.substring(this.form.image.indexOf(":"),this.form.image.indexOf(";")).replace(":",""),o=n[0].id+"."+s.split("/")[1];{const{error:e}=await ct.storage.from("sellers-headings").upload(o,this.form.image,{cacheControl:"3600",upsert:!0,contentType:s});if(e)throw e}{const{error:e}=await ct.from("companies").update({header_picture:o}).eq("id",n[0].id);if(e)throw e}}this.successAlertTitle="",this.store.commit("setState","success"),e.classList.remove("is-valid"),e.classList.remove("is-invalid"),t.classList.remove("is-valid"),t.classList.remove("is-invalid"),i.classList.remove("is-valid"),i.classList.remove("is-invalid"),a.classList.remove("is-valid"),a.classList.remove("is-invalid")}catch(n){this.failureAlertTitle="Fehler",this.failureAlertInfo="Beim Ändern der Unternehmens-Daten ist ein Fehler aufgetreten!",this.store.commit("setState","failure"),this.cancelCompanyChange(),console.log(n.error_description||n.message)}},async saveEmployees(){try{const t=[];var e=document.getElementsByClassName("employees-mail");if(Array.from(e).forEach((e=>{""!=e.value&&t.push(e.value),e.classList.remove("is-valid"),e.classList.remove("is-invalid")})),JSON.stringify(t)!=JSON.stringify(this.company.employees)){const{error:e}=await ct.from("companies").update({employees:t}).eq("user_uid",this.userData.id);if(e)throw e}this.isEmployeesEditing=!1,this.saveEmployeesPressed=!1,Array.from(e).forEach((e=>{e.classList.remove("is-valid"),e.classList.remove("is-invalid")}))}catch(t){this.failureAlertTitle="Fehler",this.failureAlertInfo="Beim Ändern der Mitarbeiter ist ein Fehler aufgetreten!",this.store.commit("setState","failure"),this.cancelEmployeesChange(),console.log(t.error_description||t.message)}},cancelCompanyChange(){this.isCompanyEditing=!1,this.saveCompanyPressed=!1;var e=document.getElementById("company-name"),t=document.getElementById("company-location"),i=document.getElementById("company-category"),a=document.getElementById("company-info");e.value=this.company.name,t.value=this.company.location,i.value=this.company.categories[0],a.value=this.company.info,e.classList.remove("is-valid"),e.classList.remove("is-invalid"),t.classList.remove("is-valid"),t.classList.remove("is-invalid"),i.classList.remove("is-valid"),i.classList.remove("is-invalid"),a.classList.remove("is-valid"),a.classList.remove("is-invalid")},cancelEmployeesChange(){this.isEmployeesEditing=!1,this.saveEmployeesPressed=!1,this.employees=this.company.employees.filter((e=>""!=e)),console.log(this.employees);var e=document.getElementsByClassName("employees-mail"),t=0;Array.from(e).forEach((e=>{e.value=this.employees[t],e.classList.remove("is-valid"),e.classList.remove("is-invalid"),t++}))}}};const Hs=(0,k.Z)($s,[["render",ot],["__scopeId","data-v-e7eff258"]]);var Ys=Hs;const Js={key:0,class:"mb-4"},Qs=(0,s._)("h3",{class:"mb-2"}," Nicht verifiziert ",-1),Xs={class:"list"},eo={key:1,class:"mb-4 mt-4"},to=(0,s._)("h3",{class:"mb-2"}," Kein Abo ausgewählt ",-1),io={class:"list"},ao={class:"mt-4"},so={key:2,class:"spinner-border",style:{width:"4rem",height:"4rem","border-width":"7px"},role:"status"},oo=(0,s._)("span",{class:"visually-hidden"},"Loading...",-1),no=[oo];function ro(e,t,i,a,o,n){const r=(0,s.up)("TitleDiv"),l=(0,s.up)("CompanyTile"),c=(0,s.up)("CompanySortableList");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(r,{title:"Unternehmen"}),o.notVerfiedCompanies.length>0?((0,s.wg)(),(0,s.iD)("div",Js,[Qs,(0,s._)("div",Xs,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.notVerfiedCompanies,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e.id},[(0,s.Wm)(l,{data:e,class:"item"},null,8,["data"])])))),128)),((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(2,(e=>(0,s._)("div",{key:e,class:"item"}))),64))])])):(0,s.kq)("",!0),o.noAboCompanies.length>0?((0,s.wg)(),(0,s.iD)("div",eo,[to,(0,s._)("div",io,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.noAboCompanies,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e.id},[(0,s.Wm)(l,{data:e,class:"item"},null,8,["data"])])))),128)),((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(2,(e=>(0,s._)("div",{key:e,class:"item"}))),64))])])):(0,s.kq)("",!0),(0,s._)("div",ao,[o.companies.length>0?((0,s.wg)(),(0,s.j4)(c,{key:0,items:o.companies,loading:o.loading,element:"CompanyTile"},null,8,["items","loading"])):(0,s.kq)("",!0)]),o.loading?((0,s.wg)(),(0,s.iD)("div",so,no)):(0,s.kq)("",!0)],64)}const lo=e=>((0,s.dD)("data-v-74fdadd9"),e=e(),(0,s.Cn)(),e),co=lo((()=>(0,s._)("div",{class:"col-md-3 col-xl-4"},null,-1))),uo={key:0,class:"search-comp col-12 col-md-6 col-xl-4"},po={key:1,class:"search-comp col-12 col-md-6 col-xl-4"},mo={key:0,class:"alias-wrapper"},ho={class:"alias-suggestions"},go={class:"btn btn-light alias-link"},yo=lo((()=>(0,s._)("i",{class:"fa-solid fa-arrow-right"},null,-1))),fo=lo((()=>(0,s._)("div",{class:"col-md-3 col-xl-4"},null,-1))),vo=lo((()=>(0,s._)("div",{class:"col-md-3 col-xl-4"},null,-1))),bo={class:"col-12 col-md-6 col-xl-4"},wo={class:"settings"},_o={key:0,class:"fa-solid fa-arrow-down fa-lg"},ko={key:1,class:"fa-solid fa-arrow-up fa-lg"},Eo=(0,s.uE)('<option value="" selected data-v-74fdadd9>Kategorie</option><option value="Gastronomie" data-v-74fdadd9>Gastronomie</option><option value="Kultur" data-v-74fdadd9>Kultur</option><option value="Dienstleistung" data-v-74fdadd9>Dienstleistung</option><option value="Gastronomie &amp; Dienstleistung" data-v-74fdadd9> Gastronomie &amp; Dienstleistung </option>',5),Co=[Eo],So=(0,s.uE)('<option value="" selected data-v-74fdadd9>Kategorie</option><option value="Essen" data-v-74fdadd9>Essen</option><option value="Trinken" data-v-74fdadd9>Trinken</option><option value="Gegenstand" data-v-74fdadd9>Gegenstand</option><option value="Dienstleistung" data-v-74fdadd9>Dienstleistung</option>',5),Do=[So],Io=lo((()=>(0,s._)("option",{value:"relevance",selected:""},"Sortieren",-1))),Po=lo((()=>(0,s._)("option",{value:"relevance"},"Relevanz",-1))),Bo=lo((()=>(0,s._)("option",{value:"review"},"Bewertung",-1))),xo=lo((()=>(0,s._)("option",{value:"name"},"Name",-1))),Ao=[Io,Po,Bo,xo],To=lo((()=>(0,s._)("option",{value:"relevance",selected:""},"Sortieren",-1))),Lo=lo((()=>(0,s._)("option",{value:"price"},"Preis",-1))),qo=lo((()=>(0,s._)("option",{value:"review"},"Bewertung",-1))),Oo=lo((()=>(0,s._)("option",{value:"name"},"Name",-1))),Uo=[To,Lo,qo,Oo],Fo={class:"sortable-list",ref:"sortableList"},jo={key:0,style:{"margin-bottom":"50px"}},zo={key:0,class:"empty"},Mo={key:1,class:"empty"};function Vo(e,t,i,o,n,r){const l=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",{class:(0,ut.C_)(["row",{noSearch:i.noSearch}])},[co,i.noSearch?((0,s.wg)(),(0,s.iD)("div",uo)):((0,s.wg)(),(0,s.iD)("div",po,[(0,s.wy)((0,s._)("input",{class:"search form-control form-control-lg me-2",type:"search",placeholder:"Suchen...","aria-label":"Suchen...","on-":"",onFocus:t[0]||(t[0]=e=>n.focus=!0),onFocusout:t[1]||(t[1]=e=>r.removeFocus()),"onUpdate:modelValue":t[2]||(t[2]=e=>n.searchString=e)},null,544),[[a.nr,n.searchString]]),this.directLinks.length>0&&this.focus?((0,s.wg)(),(0,s.iD)("div",mo,[(0,s._)("div",ho,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.directLinks,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e.id,style:{display:"block"}},[(0,s.Wm)(l,{to:e.alias},{default:(0,s.w5)((()=>[(0,s._)("button",go,[(0,s.Uk)((0,ut.zw)(e.alias)+" ",1),yo])])),_:2},1032,["to"])])))),128))])])):(0,s.kq)("",!0)])),fo,vo,(0,s._)("div",bo,[(0,s._)("div",wo,[(0,s._)("button",{class:"direction btn btn-outline-secondary",onClick:t[3]||(t[3]=e=>["up"==n.dir?n.dir="down":n.dir="up"])},["up"==n.dir?((0,s.wg)(),(0,s.iD)("i",_o)):((0,s.wg)(),(0,s.iD)("i",ko))]),"CompanyTile"==i.element?((0,s.wg)(),(0,s.iD)("select",{key:0,onChange:t[4]||(t[4]=(...e)=>r.companyCategoryChange&&r.companyCategoryChange(...e)),id:"companyCategory",class:"form-select form-select-md mb-3","aria-label":".form-select-lg example"},Co,32)):((0,s.wg)(),(0,s.iD)("select",{key:1,onChange:t[5]||(t[5]=(...e)=>r.productCategoryChange&&r.productCategoryChange(...e)),id:"productCategory",class:"form-select form-select-md mb-3","aria-label":".form-select-lg example"},Do,32)),"CompanyTile"==i.element?((0,s.wg)(),(0,s.iD)("select",{key:2,onChange:t[6]||(t[6]=(...e)=>r.companySortChange&&r.companySortChange(...e)),id:"companySort",class:"form-select form-select-right form-select-md mb-3","aria-label":".form-select-lg example"},Ao,32)):((0,s.wg)(),(0,s.iD)("select",{key:3,onChange:t[7]||(t[7]=(...e)=>r.productSortChange&&r.productSortChange(...e)),id:"productSort",class:"form-select form-select-right form-select-md mb-3","aria-label":".form-select-lg example"},Uo,32))])])],2),(0,s._)("div",Fo,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.sortedShownItems,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e.id},[((0,s.wg)(),(0,s.j4)((0,s.LL)(i.element),{data:e,class:"item"},null,8,["data"]))])))),128)),((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(2,(e=>(0,s._)("div",{key:e,class:"item"}))),64))],512),0!=n.shownItems.length||i.loading?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",jo,["CompanyTile"==i.element?((0,s.wg)(),(0,s.iD)("h4",zo," Es wurden keine Unternehmen gefunden ")):((0,s.wg)(),(0,s.iD)("h4",Mo,"Es wurden keine Produkte gefunden"))]))],64)}const No=e=>((0,s.dD)("data-v-29e484ab"),e=e(),(0,s.Cn)(),e),Go={class:"sizing"},Zo={class:"card"},Wo={class:"image"},Ro={key:0,class:"no-image"},Ko=No((()=>(0,s._)("i",{class:"fa-solid fa-image fa-2xl"},null,-1))),$o=[Ko],Ho=["src"],Yo={class:"row"},Jo={class:"col-9 name highlight"},Qo={class:"col-3"},Xo={class:"category highlight"},en={class:"row"},tn={class:"col-9 location"},an=No((()=>(0,s._)("i",{class:"fa-solid fa-location-dot"},null,-1))),sn={class:"location-text"};function on(e,t,i,a,o,n){const r=(0,s.up)("CompanyBadge"),l=(0,s.up)("router-link");return(0,s.wg)(),(0,s.j4)(l,{to:n.link,class:"hover"},{default:(0,s.w5)((()=>[(0,s._)("div",Go,[(0,s._)("div",Zo,[(0,s._)("div",Wo,[null==this.picture?((0,s.wg)(),(0,s.iD)("div",Ro,$o)):((0,s.wg)(),(0,s.iD)("img",{key:1,src:o.picture,alt:""},null,8,Ho))]),(0,s._)("div",Yo,[(0,s._)("h2",Jo,(0,ut.zw)(i.data.name),1),(0,s._)("div",Qo,[(0,s.Wm)(r,{verified:i.data.verified,premium:"Business"==i.data.abo,self:"schillerando"==i.data.alias,class:"company-badge"},null,8,["verified","premium","self"])])]),(0,s._)("div",Xo,(0,ut.zw)(i.data.categories[0]),1),(0,s._)("div",en,[(0,s._)("div",tn,[an,(0,s._)("div",sn,(0,ut.zw)(i.data.location),1)])])])])])),_:1},8,["to"])}const nn=["data-bs-content"],rn={class:"container_row"},ln={key:0,class:"layer2 fa-solid fa-house fa-xs"},cn={key:1,class:"layer2 fa-solid fa-crown fa-xs"},dn={key:2,class:"layer2 fa-solid fa-check fa-sm"};function un(e,t,i,a,o,n){return i.verified||i.premium?((0,s.wg)(),(0,s.iD)("a",{key:0,tabindex:"0",role:"button","data-bs-toggle":"popover","data-bs-trigger":"focus","data-bs-placement":"left","data-bs-content":[i.self?"Das sind wir!":i.premium?"Schillerando Premium-Partner":"Verifizierter Schillerando-Partner"]},[(0,s._)("div",rn,[(0,s._)("i",{class:"layer1 fa-solid fa-certificate fa-xl",style:(0,ut.j5)({color:[i.self?"#00a100":i.premium?"#f6b600":"#3798f0"]})},null,4),i.self?((0,s.wg)(),(0,s.iD)("i",ln)):i.premium?((0,s.wg)(),(0,s.iD)("i",cn)):((0,s.wg)(),(0,s.iD)("i",dn))])],8,nn)):(0,s.kq)("",!0)}var pn={name:"CompanyBadge",props:{verified:Boolean,premium:Boolean,self:Boolean},mounted(){Array.from(document.querySelectorAll('a[data-bs-toggle="popover"]')).forEach((e=>new x.Popover(e,{html:!0})))}};const mn=(0,k.Z)(pn,[["render",un],["__scopeId","data-v-71ea8494"]]);var hn=mn,gn={name:"CompanyTile",props:["data"],data(){return{picture:null}},components:{CompanyBadge:hn},async mounted(){if(null!=this.data.header_picture){const e=await ct.storage.from("public/sellers-headings").download(this.data.header_picture);null!=e.data&&(this.picture=await e.data.text()),e.error&&console.warn(e.error)}},computed:{link(){return`/${this.data.alias}`}}};const yn=(0,k.Z)(gn,[["render",on],["__scopeId","data-v-29e484ab"]]);var fn=yn,vn={name:"SortableList",data(){return{categories:[],chosenCategories:[],searchString:"",shownItems:[],sortedShownItems:[],sortBy:"CompanyTile"==this.element?"relevance":"",dir:"up",directLinks:[],focus:!1}},props:["items","element","loading","noSearch"],methods:{sort:function(){this.sortedShownItems=this.shownItems,""!=this.sortBy&&(this.sortedShownItems.sort(((e,t)=>"string"==typeof e[this.sortBy]&&"string"==typeof t[this.sortBy]?e[this.sortBy].localeCompare(t[this.sortBy]):e[this.sortBy]>t[this.sortBy]?1:e[this.sortBy]<t[this.sortBy]?-1:0)),"down"==this.dir&&this.sortedShownItems.reverse())},searchForString:function(e,t){if(e.startsWith("/")&&(e=e.substring(1)),null==t)return 0;let i=0;if("object"==typeof t){if(!(t instanceof Array)){let e=[],i=[];i="CompanyTile"==this.element?["name","location","info"]:["name","company_name","info"],i.forEach((i=>e.push(t[i]))),t=e}for(let a=0;a<t.length;a++)i+=this.searchForString(e,t[a]);return i}if("string"!=typeof t)return 0;let a=t.match(new RegExp(e,"gi"));return null==a?0:a.length},generateShownItems:function(){let e=[];for(let t=0;t<this.items.length;t++){let i=this.items[t],a=!0;if(0==this.searchForString(this.searchString,i)&&(a=!1),null==i.categories&&0!=this.chosenCategories.length)a=!1;else for(let e=0;e<this.chosenCategories.length;e++)i.categories.includes(this.chosenCategories[e])||(a=!1),"Gastronomie & Dienstleistung"!=i.categories[0]||"Gastronomie"!=this.chosenCategories[e]&&"Dienstleistung"!=this.chosenCategories[e]||(a=!0);a&&e.push(i)}e!=this.shownItems&&(this.shownItems=e,this.sort())},generateCategories:function(){for(let e=0;e<this.items.length;e++){let t=this.items[e];if(null!=t.categories)for(let e=0;e<t.categories.length;e++){let i=t.categories[e];this.categories.includes(i)||this.categories.push(i)}}},companyCategoryChange(){const e=document.getElementById("companyCategory"),t=e.value;this.chosenCategories=""==t?[]:[t]},productCategoryChange(){const e=document.getElementById("productCategory"),t=e.value;this.chosenCategories=""==t?[]:[t]},companySortChange(){const e=document.getElementById("companySort"),t=e.value;this.sortBy=t,console.log(t)},productSortChange(){const e=document.getElementById("productSort"),t=e.value;this.sortBy=t},aliasRoute(e){Hn.addRoute({path:"/"+e}),Hn.forward(),console.log("/"+e)},removeFocus(){setTimeout(function(){this.focus=!1}.bind(this),200)}},mounted(){this.generateCategories(),this.generateShownItems()},watch:{items:function(){this.generateCategories(),this.generateShownItems()},element:function(){this.generateShownItems()},searchString:function(){if(this.generateShownItems(),this.directLinks=[],"CompanyTile"==this.element&&this.searchString.startsWith("/"))for(let e=0;e<this.items.length;e++)void 0!==this.items[e].alias&&this.items[e].alias.startsWith(this.searchString.substring(1))&&this.directLinks.push(this.items[e])},dir:function(){this.generateShownItems()},sortBy:function(){this.generateShownItems()},chosenCategories:function(){this.generateShownItems()}},components:{ProductTile:ks,CompanyTile:fn}};const bn=(0,k.Z)(vn,[["render",Vo],["__scopeId","data-v-74fdadd9"]]);var wn=bn,_n={name:"CompanyView",components:{TitleDiv:ii,CompanySortableList:wn,CompanyTile:fn},data(){return{companies:[],notVerfiedCompanies:[],noAboCompanies:[],loading:!0}},async created(){const{data:e,error:t}=await ct.from("companies").select();null!=t&&console.log(t),e.forEach((e=>{null==e.abo?this.noAboCompanies.push(e):1!=e.verified?this.notVerfiedCompanies.push(e):this.companies.push(e)})),this.loading=!1}};const kn=(0,k.Z)(_n,[["render",ro]]);var En=kn;function Cn(e,t,i,a,o,n){const r=(0,s.up)("TitleDiv");return(0,s.wg)(),(0,s.j4)(r,{title:"Services"})}var Sn={name:"ServiceView",components:{TitleDiv:ii}};const Dn=(0,k.Z)(Sn,[["render",Cn]]);var In=Dn;function Pn(e,t,i,a,o,n){const r=(0,s.up)("TitleDiv");return(0,s.wg)(),(0,s.j4)(r,{title:"Einstellungen"})}var Bn={name:"SettingsView",components:{TitleDiv:ii},data(){return{}}};const xn=(0,k.Z)(Bn,[["render",Pn]]);var An=xn;function Tn(e,t,i,a,o,n){const r=(0,s.up)("TitleDiv");return(0,s.wg)(),(0,s.j4)(r,{title:"Bestellungen"})}var Ln={name:"OrderView",components:{TitleDiv:ii},data(){return{newOrders:[],oldOrders:[]}},async mounted(){if(this.$route.params.companyalias){const{data:e,error:t}=await ct.from("orders").select().order("day",{ascending:!1}).order("order_time",{ascending:!1});if(null!=t&&console.log(t),null===e||0===e.length)return;e.forEch((e=>{e.delivered&&e.payed?this.oldOrders.push(e):this.newOrders.push(e)}))}}};const qn=(0,k.Z)(Ln,[["render",Tn]]);var On=qn;function Un(e,t,i,a,o,n){const r=(0,s.up)("TitleDiv");return(0,s.wg)(),(0,s.j4)(r,{title:"Nutzer"})}var Fn={name:"UserView",components:{TitleDiv:ii},data(){return{}}};const jn=(0,k.Z)(Fn,[["render",Un]]);var zn=jn;function Mn(e,t,i,a,o,n){const r=(0,s.up)("TitleDiv");return(0,s.wg)(),(0,s.j4)(r,{title:"Statistiken"})}var Vn={name:"StatsView",components:{TitleDiv:ii},data(){return{}}};const Nn=(0,k.Z)(Vn,[["render",Mn]]);var Gn=Nn,Zn=i(4702);const Wn=(0,V.MT)({state:{user:null,session:null,state:void 0,currentProduct:null,currentEntry:null},mutations:{setUser(e,t){e.user=t},setState(e,t){e.state=t},setCurrentProduct(e,t){e.currentProduct=t},setCurrentEntry(e,t){e.currentEntry=t}},getters:{getUser(e){return e.user},getState(e){return e.state},getCurrentProduct(e){return e.currentProduct},getCurrentEntry(e){return e.currentEntry}},actions:{async reload({commit:e}){console.log("reload");var t=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);t=!0;try{const{data:a,error:s}=await ct.auth.refreshSession();if(s||null==a.session)t?e("setUser",null):this.dispatch("getSharedLogin");else{var i=a.user;null!=this.state.user&&(i.role=this.state.user.role),e("setUser",i)}}catch(a){e("setUser",null)}if(null!=this.state.user&&"admin"!=this.state.user.role&&"driver"!=this.state.user.role){i=this.getters.getUser;try{const{data:e,error:t}=await ct.from("user_roles").select().eq("id",i.id);if(t)throw t;null!=e&&(i.role=e[0].role)}catch(a){console.log(a)}e("setUser",i)}t||(this.timer=setInterval((()=>{this.dispatch("getSharedLogin")}),1e3))},async getSharedLogin({commit:e}){const t=document.cookie.split(/\s*;\s*/).map((e=>e.split("="))),i=t.find((e=>"supabase-access-token"==e[0])),a=t.find((e=>"supabase-refresh-token"==e[0]));if(i&&a){if(null!=this.getters.getUser)return;const{data:t,error:s}=await ct.auth.setSession({access_token:i[1],refresh_token:a[1]});s||null==t.session?(e("setUser",null),document.cookie="supabase-access-token=false;",document.cookie="supabase-refresh-token=false;",Hn.go(Hn.currentRoute)):null!=this.getters.getUser?e("setUser",t.user):(e("setUser",t.user),Hn.go(Hn.currentRoute))}else null!=this.getters.getUser?(e("setUser",null),Hn.go(Hn.currentRoute)):e("setUser",null)},async createCompany({commit:e},t){try{e("setState","loading");const c=t.name.replace(/\s/g,"").toLowerCase();var i=t.employees.filter((function(e,i){return t.employees.indexOf(e)==i}));const{data:d,error:u}=await ct.from("companies").insert({alias:c,name:t.name,categories:[t.category],location:t.location,info:t.info,user_uid:this.getters.getUser.id,employees:i,abo:"Later"==t.abo?null:t.abo,relevance:"Business"==t.abo?50:100}).select();var a=d[0].id;if(u)throw u;if(null!=t.image){var s=t.image.substring(t.image.indexOf(":"),t.image.indexOf(";")).replace(":",""),o=d[0].id+"."+s.split("/")[1];{const{error:e}=await ct.storage.from("sellers-headings").upload(o,t.image,{cacheControl:"3600",upsert:!0,contentType:s});if(e)throw e}{const{error:e}=await ct.from("companies").update({header_picture:o}).eq("id",this.getters.companyId);if(e)throw e}}if(u)throw u;e("setUser",d.user);for(var n=0;n<t.products.length;n++){const e=t.products[n],{data:i,error:o}=await ct.from("products").insert({name:e.name,info:e.info,price:e.price,categories:e.categories,company_id:a,auth_uid:this.getters.getUser.id,delivery:e.delivery,public:e.public}).select();if(o)throw o;if(null!=e.image){var r=e.image.substring(e.image.indexOf(":"),e.image.indexOf(";")).replace(":",""),l=i[0].id+"."+s.split("/")[1];{const{error:t}=await ct.storage.from("products-pictures").upload(l,e.image,{cacheControl:"3600",upsert:!0,contentType:r});if(t)throw t}{const{error:e}=await ct.from("products").update({product_picture:l}).eq("id",i[0].id);if(e)throw e}}}console.log("Successfully registered"),e("setState","success"),await Hn.replace("/einstellungen")}catch(c){e("setState","failure"),console.log(c.error_description||c.message)}},async updateProduct({commit:e},t){try{e("setState","loading");const{data:s,error:o}=await ct.from("products").update({name:t.name,info:t.info,categories:t.categories,price:t.price,delivery:t.delivery,public:t.public}).eq("id",t.id).select();if(o)throw o;if(e("setCurrentProduct",s[0]),null!=t.image&&t.imageBefore!=t.image){if(null!=t.imageBefore){const{error:e}=await ct.storage.from("products-pictures").remove(s[0].product_picture);if(e)throw e}var i=t.image.substring(t.image.indexOf(":"),t.image.indexOf(";")).replace(":",""),a=t.id+"."+i.split("/")[1];{const{error:e}=await ct.storage.from("products-pictures").upload(a,t.image,{cacheControl:"3600",upsert:!0,contentType:i});if(e)throw e}{const{data:i,error:s}=await ct.from("products").update({product_picture:a}).eq("id",t.id).select();if(s)throw s;e("setCurrentProduct",i[0])}}e("setState","success")}catch(s){e("setCurrentProduct",null),e("setState","failure"),console.log(s.error_description||s.message)}},async deleteProduct({commit:e},t){try{if(e("setState","loading"),null!=t.product_picture){const{error:e}=await ct.storage.from("products-pictures").remove(t.product_picture);if(e)throw e}const{error:i}=await ct.from("products").delete().eq("id",t.id);if(i)throw i;e("setState","success")}catch(i){e("setState","failure"),console.log(i.error_description||i.message)}},async updateEntry({commit:e},t){try{e("setState","loading");const{data:s,error:o}=await ct.from("accounting").update({name:t.name,info:t.info,type:t.type,amount:t.type.includes("-")?-Math.abs(t.amount):Math.abs(t.amount),product:t.product.id}).eq("id",t.id).select();if(o)throw o;if(e("setCurrentEntry",s[0]),null!=t.image&&t.imageBefore!=t.image){if(null!=t.imageBefore){const{error:e}=await ct.storage.from("bill-pictures/"+t.companyData.id).remove(s[0].bill_picture);if(e)throw e}var i=t.image.substring(t.image.indexOf(":"),t.image.indexOf(";")).replace(":",""),a=t.id+"."+i.split("/")[1];{const{error:e}=await ct.storage.from("bill-pictures/"+t.companyData.id).upload(a,t.image,{cacheControl:"3600",upsert:!0,contentType:i});if(e)throw e}{const{data:i,error:s}=await ct.from("accounting").update({bill_picture:a}).eq("id",t.id).select();if(s)throw s;e("setCurrentEntry",i[0])}}e("setState","success")}catch(s){e("setCurrentEntry",null),e("setState","failure"),console.log(s.error_description||s.message)}},async deleteEntry({commit:e},t){try{if(e("setState","loading"),null!=t.product_picture){const{error:e}=await ct.storage.from("bill-pictures/"+t.companyData.id).remove(t.bill_picture);if(e)throw e}const{error:i}=await ct.from("accounting").delete().eq("id",t.id);if(i)throw i;e("setState","success")}catch(i){e("setState","failure"),console.log(i.error_description||i.message)}}},modules:{},plugins:[(0,Zn.Z)()]});var Rn=Wn;const Kn=[{path:"/",alias:["/stats"],name:"StatsView",component:Gn},{path:"/orders",name:"OrderView",component:On},{path:"/services",name:"ServiceView",component:In},{path:"/companies",name:"CompanyView",component:En},{path:"/users",name:"UserView",component:zn},{path:"/settings",name:"SettingsView",component:An,meta:{locked:!0,noAccess:!0}},{path:"/:companyalias",component:Ys,meta:{footer:!1,locked:!0,noAccess:!0}}],$n=(0,N.p7)({history:(0,N.PO)("/"),routes:Kn,scrollBehavior(){document.getElementById("app").scrollIntoView({behavior:"smooth"}),document.getElementById("navbarToggler").classList.remove("show")}});$n.beforeEach((async(e,t,i)=>{if("true"==e.query.int&&null!=e.query.access_token&&"null"!=e.query.access_token)try{var a=null;{const{data:t}=await ct.auth.setSession({access_token:e.query.access_token,refresh_token:e.query.refresh_token});a=t.user}{console.log(a);const{data:e,error:t}=await ct.from("user_roles").select().eq("id",a.id);if(t)throw t;null!=e&&(a.role=e[0].role)}Rn.commit("setUser",a)}catch(o){Rn.commit("setUser",null)}else"true"==e.query.int&&await new Promise((e=>setTimeout(e,500)));var s=Rn.getters.getUser;null==s?(window.location.replace("https://schillerando.de/auth?redirect=int_"+e.path),i()):"admin"!=s.role&&"driver"!=s.role?(window.location.replace("https://schillerando.de"),i()):i()}));var Hn=$n;(0,a.ri)($).use(Rn).use(Hn).mount("#app")}},t={};function i(a){var s=t[a];if(void 0!==s)return s.exports;var o=t[a]={exports:{}};return e[a].call(o.exports,o,o.exports,i),o.exports}i.m=e,function(){var e=[];i.O=function(t,a,s,o){if(!a){var n=1/0;for(d=0;d<e.length;d++){a=e[d][0],s=e[d][1],o=e[d][2];for(var r=!0,l=0;l<a.length;l++)(!1&o||n>=o)&&Object.keys(i.O).every((function(e){return i.O[e](a[l])}))?a.splice(l--,1):(r=!1,o<n&&(n=o));if(r){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[a,s,o]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};i.t=function(a,s){if(1&s&&(a=this(a)),8&s)return a;if("object"===typeof a&&a){if(4&s&&a.__esModule)return a;if(16&s&&"function"===typeof a.then)return a}var o=Object.create(null);i.r(o);var n={};e=e||[null,t({}),t([]),t(t)];for(var r=2&s&&a;"object"==typeof r&&!~e.indexOf(r);r=t(r))Object.getOwnPropertyNames(r).forEach((function(e){n[e]=function(){return a[e]}}));return n["default"]=function(){return a},i.d(o,n),o}}(),function(){i.d=function(e,t){for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){i.p="/"}(),function(){var e={143:0};i.O.j=function(t){return 0===e[t]};var t=function(t,a){var s,o,n=a[0],r=a[1],l=a[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(s in r)i.o(r,s)&&(i.m[s]=r[s]);if(l)var d=l(i)}for(t&&t(a);c<n.length;c++)o=n[c],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return i.O(d)},a=self["webpackChunkintern"]=self["webpackChunkintern"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=i.O(void 0,[998],(function(){return i(2768)}));a=i.O(a)})();
//# sourceMappingURL=app.8f06f78b.js.map